<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">

<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"/>
  <meta name="generator" content="distill" />

  <style type="text/css">
  /* Hide doc at startup (prevent jankiness while JS renders/transforms) */
  body {
    visibility: hidden;
  }
  </style>

 <!--radix_placeholder_import_source-->
 <!--/radix_placeholder_import_source-->

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  { color: #00769e; background-color: #f1f3f5; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span { color: #00769e; } /* Normal */
code span.al { color: #ad0000; } /* Alert */
code span.an { color: #5e5e5e; } /* Annotation */
code span.at { color: #657422; } /* Attribute */
code span.bn { color: #ad0000; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #00769e; } /* ControlFlow */
code span.ch { color: #20794d; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #5e5e5e; } /* Comment */
code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
code span.dt { color: #ad0000; } /* DataType */
code span.dv { color: #ad0000; } /* DecVal */
code span.er { color: #ad0000; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #ad0000; } /* Float */
code span.fu { color: #4758ab; } /* Function */
code span.im { } /* Import */
code span.in { color: #5e5e5e; } /* Information */
code span.kw { color: #00769e; } /* Keyword */
code span.op { color: #5e5e5e; } /* Operator */
code span.ot { color: #00769e; } /* Other */
code span.pp { color: #ad0000; } /* Preprocessor */
code span.sc { color: #5e5e5e; } /* SpecialChar */
code span.ss { color: #20794d; } /* SpecialString */
code span.st { color: #20794d; } /* String */
code span.va { color: #111111; } /* Variable */
code span.vs { color: #20794d; } /* VerbatimString */
code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
</style>

<style>
  div.csl-bib-body { }
  div.csl-entry {
    clear: both;
    }
  .hanging div.csl-entry {
    margin-left:2em;
    text-indent:-2em;
  }
  div.csl-left-margin {
    min-width:2em;
    float:left;
  }
  div.csl-right-inline {
    margin-left:2em;
    padding-left:1em;
  }
  div.csl-indent {
    margin-left: 2em;
  }
</style>

  <!--radix_placeholder_meta_tags-->
  <title>Modeling false-positive detections through a count-detection framework: literature review</title>

  <meta property="description" itemprop="description" content="A review of false positive occupancy modeling (mostly) after 2020"/>


  <!--  https://schema.org/Article -->
  <meta property="article:published" itemprop="datePublished" content="2022-12-13"/>
  <meta property="article:created" itemprop="dateCreated" content="2022-12-13"/>
  <meta name="article:author" content="Jacob Oram"/>

  <!--  https://developers.facebook.com/docs/sharing/webmasters#markup -->
  <meta property="og:title" content="Modeling false-positive detections through a count-detection framework: literature review"/>
  <meta property="og:type" content="article"/>
  <meta property="og:description" content="A review of false positive occupancy modeling (mostly) after 2020"/>
  <meta property="og:locale" content="en_US"/>

  <!--  https://dev.twitter.com/cards/types/summary -->
  <meta property="twitter:card" content="summary"/>
  <meta property="twitter:title" content="Modeling false-positive detections through a count-detection framework: literature review"/>
  <meta property="twitter:description" content="A review of false positive occupancy modeling (mostly) after 2020"/>

  <!--/radix_placeholder_meta_tags-->
  
  <meta name="citation_reference" content="citation_title=Modelling misclassification in multi‐species acoustic data when estimating occupancy and relative activity;citation_publisher=Wiley;citation_volume=11;citation_issn=2041-210X;citation_author=Wilson J. Wright;citation_author=Kathryn M. Irvine;citation_author=Emily S. Almberg;citation_author=Andrea R. Litt;citation_author=Nigel Yoccoz"/>
  <meta name="citation_reference" content="citation_title=Estimating species misclassification with occupancy dynamics and encounter rates: A semi-supervised, individual-level approach;citation_volume=13;citation_doi=https://doi.org/10.1111/2041-210X.13858;citation_author=Anna I. Spiers;citation_author=J. Andrew Royle;citation_author=Christa L. Torrens;citation_author=Maxwell B. Joseph"/>
  <meta name="citation_reference" content="citation_title=Estimating occupancy from autonomous recording unit data in the presence of misclassifications and detection heterogeneity;citation_volume=n/a;citation_doi=https://doi.org/10.1111/2041-210X.13895;citation_author=Matthew J. Clement;citation_author=J. Andrew Royle;citation_author=Ronald J. Mixan"/>
  <meta name="citation_reference" content="citation_title=Statistical assessment on determining local presence of rare bat species;citation_volume=13;citation_doi=https://doi.org/10.1002/ecs2.4142;citation_author=Kathryn M. Irvine;citation_author=Katharine M. Banner;citation_author=Christian Stratton;citation_author=William M. Ford;citation_author=Brian E. Reichert"/>
  <meta name="citation_reference" content="citation_title=Coupling validation effort with in situ bioacoustic data improves estimating relative activity and occupancy for multiple species with cross-species misclassifications;citation_volume=13;citation_doi=https://doi.org/10.1111/2041-210X.13831;citation_author=Christian Stratton;citation_author=Kathryn M. Irvine;citation_author=Katharine M. Banner;citation_author=Wilson J. Wright;citation_author=Cori Lausen;citation_author=Jason Rae"/>
  <meta name="citation_reference" content="citation_title=Accounting for misclassification in multispecies distribution models;citation_publisher=arXiv;citation_doi=10.48550/ARXIV.2204.03708;citation_author=Kwaku Peprah Adjei;citation_author=Robert Bob O’Hara;citation_author=Anders G. Finstad;citation_author=Wouter Koch"/>
  <meta name="citation_reference" content="citation_title=A continuous-score occupancy model that incorporates uncertain machine learning output from autonomous biodiversity surveys;citation_volume=13;citation_doi=https://doi.org/10.1111/2041-210X.13905;citation_author=Tessa A. Rhinehart;citation_author=Daniel Turek;citation_author=Justin Kitzes"/>
  <meta name="citation_reference" content="citation_title=Integrated community occupancy models: A framework to assess occurrence and biodiversity dynamics using multiple data sources;citation_volume=13;citation_doi=https://doi.org/10.1111/2041-210X.13811;citation_author=Jeffrey W. Doser;citation_author=Wendy Leuenberger;citation_author=T. Scott Sillett;citation_author=Michael T. Hallworth;citation_author=Elise F. Zipkin"/>
  <meta name="citation_reference" content="citation_title=Generalized model-based solutions to false-positive error in species detection/nondetection data;citation_volume=102;citation_doi=https://doi.org/10.1002/ecy.3241;citation_author=John D. J. Clare;citation_author=Philip A. Townsend;citation_author=Benjamin Zuckerberg"/>
  <!--radix_placeholder_rmarkdown_metadata-->

  <script type="text/json" id="radix-rmarkdown-metadata">
  {"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["title","description","author","date","output","bibliography","csl"]}},"value":[{"type":"character","attributes":{},"value":["Modeling false-positive detections through a count-detection framework: literature review"]},{"type":"character","attributes":{},"value":["A review of false positive occupancy modeling (mostly) after 2020\n"]},{"type":"list","attributes":{},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","affiliation","affiliation_url"]}},"value":[{"type":"character","attributes":{},"value":["Jacob Oram"]},{"type":"character","attributes":{},"value":["Montana State University"]},{"type":"character","attributes":{},"value":["https://math.montana.edu/"]}]}]},{"type":"character","attributes":{},"value":["2022-12-13"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["distill::distill_article"]}},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["self_contained","toc","toc_depth"]}},"value":[{"type":"logical","attributes":{},"value":[false]},{"type":"logical","attributes":{},"value":[true]},{"type":"integer","attributes":{},"value":[2]}]}]},{"type":"character","attributes":{},"value":["LR_reference.bib"]},{"type":"character","attributes":{},"value":["biometrics_notes.csl"]}]}
  </script>
  <!--/radix_placeholder_rmarkdown_metadata-->
  
  <script type="text/json" id="radix-resource-manifest">
  {"type":"character","attributes":{},"value":[" lit/Adjei_misclass_IPP.pdf"," lit/Chambert17_analysing automated acoustic species detection data Occupancy.pdf"," lit/clemet-et-al2022_mee313895-sup-0001-supinfos1.docx"," lit/doser_dissertation_full .pdf"," lit/Ecology - 2020 - Clare - Generalized model‐based solutions to false‐positive error in species detection nondetection data.pdf"," lit/Guillera-Arroita_17.pdf"," lit/MEE-Stratton-Dec8-PROOF_CS.pdf"," lit/Methods Ecol Evol - 2019 - Wright - Modelling misclassification in multi‐species acoustic data when estimating occupancy.pdf"," lit/Methods Ecol Evol - 2022 - Clement - Estimating occupancy from autonomous recording unit data in the presence of.pdf"," lit/Methods Ecol Evol - 2022 - Doser - Integrated community occupancy models A framework to assess occurrence and biodiversity.pdf"," lit/Methods Ecol Evol - 2022 - Spiers - Estimating species misclassification with occupancy dynamics and encounter rates A.pdf"," lit/MLE_Assessment-FINAL-2022March11BAOApproved.pdf"," lit/Rhinehart22 - cts_score_ML_uncertainty.pdf"," lit/spiers appendix/Spiers Appendix.pdf"," lit/spiers appendix/spiers_et_al_carabid_beetles.pdf"," lit/Wright 2020 Appendix /mee313315-sup-0001-Supinfo1.pdf"," lit/Wright 2020 Appendix /mee313315-sup-0002-Supinfo2.pdf"," lit/Wright 2020 Appendix /mee313315-sup-0003-Supinfo3.pdf"," lit/Wright 2020 Appendix /mee313315-sup-0004-Supinfo4.pdf","biometrics_notes.csl","densities.png","index_files/anchor-4.2.2/anchor.min.js","index_files/bowser-1.9.3/bowser.min.js","index_files/distill-2.2.21/template.v2.js","index_files/figure-html5/unnamed-chunk-1-1.png","index_files/figure-html5/unnamed-chunk-2-1.png","index_files/figure-html5/unnamed-chunk-3-1.png","index_files/figure-html5/unnamed-chunk-4-1.png","index_files/header-attrs-2.14/header-attrs.js","index_files/header-attrs-2.16/header-attrs.js","index_files/jquery-3.6.0/jquery-3.6.0.js","index_files/jquery-3.6.0/jquery-3.6.0.min.js","index_files/jquery-3.6.0/jquery-3.6.0.min.map","index_files/popper-2.6.0/popper.min.js","index_files/tippy-6.2.7/tippy-bundle.umd.min.js","index_files/tippy-6.2.7/tippy-light-border.css","index_files/tippy-6.2.7/tippy.css","index_files/tippy-6.2.7/tippy.umd.min.js","index_files/webcomponents-2.0.0/webcomponents.js","lam_density.png","LR_reference.bib","Omega.png","Pi.png"]}
  </script>
  <!--radix_placeholder_navigation_in_header-->
  <!--/radix_placeholder_navigation_in_header-->
  <!--radix_placeholder_distill-->

  <style type="text/css">

  body {
    background-color: white;
  }

  .pandoc-table {
    width: 100%;
  }

  .pandoc-table>caption {
    margin-bottom: 10px;
  }

  .pandoc-table th:not([align]) {
    text-align: left;
  }

  .pagedtable-footer {
    font-size: 15px;
  }

  d-byline .byline {
    grid-template-columns: 2fr 2fr;
  }

  d-byline .byline h3 {
    margin-block-start: 1.5em;
  }

  d-byline .byline .authors-affiliations h3 {
    margin-block-start: 0.5em;
  }

  .authors-affiliations .orcid-id {
    width: 16px;
    height:16px;
    margin-left: 4px;
    margin-right: 4px;
    vertical-align: middle;
    padding-bottom: 2px;
  }

  d-title .dt-tags {
    margin-top: 1em;
    grid-column: text;
  }

  .dt-tags .dt-tag {
    text-decoration: none;
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0em 0.4em;
    margin-right: 0.5em;
    margin-bottom: 0.4em;
    font-size: 70%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }

  d-article table.gt_table td,
  d-article table.gt_table th {
    border-bottom: none;
    font-size: 100%;
  }

  .html-widget {
    margin-bottom: 2.0em;
  }

  .l-screen-inset {
    padding-right: 16px;
  }

  .l-screen .caption {
    margin-left: 10px;
  }

  .shaded {
    background: rgb(247, 247, 247);
    padding-top: 20px;
    padding-bottom: 20px;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  }

  .shaded .html-widget {
    margin-bottom: 0;
    border: 1px solid rgba(0, 0, 0, 0.1);
  }

  .shaded .shaded-content {
    background: white;
  }

  .text-output {
    margin-top: 0;
    line-height: 1.5em;
  }

  .hidden {
    display: none !important;
  }

  d-article {
    padding-top: 2.5rem;
    padding-bottom: 30px;
  }

  d-appendix {
    padding-top: 30px;
  }

  d-article>p>img {
    width: 100%;
  }

  d-article h2 {
    margin: 1rem 0 1.5rem 0;
  }

  d-article h3 {
    margin-top: 1.5rem;
  }

  d-article iframe {
    border: 1px solid rgba(0, 0, 0, 0.1);
    margin-bottom: 2.0em;
    width: 100%;
  }

  /* Tweak code blocks */

  d-article div.sourceCode code,
  d-article pre code {
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  }

  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: auto;
  }

  d-article div.sourceCode {
    background-color: white;
  }

  d-article div.sourceCode pre {
    padding-left: 10px;
    font-size: 12px;
    border-left: 2px solid rgba(0,0,0,0.1);
  }

  d-article pre {
    font-size: 12px;
    color: black;
    background: none;
    margin-top: 0;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;

    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;

    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }

  d-article pre a {
    border-bottom: none;
  }

  d-article pre a:hover {
    border-bottom: none;
    text-decoration: underline;
  }

  d-article details {
    grid-column: text;
    margin-bottom: 0.8em;
  }

  @media(min-width: 768px) {

  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: visible !important;
  }

  d-article div.sourceCode pre {
    padding-left: 18px;
    font-size: 14px;
  }

  d-article pre {
    font-size: 14px;
  }

  }

  figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }

  /* CSS for d-contents */

  .d-contents {
    grid-column: text;
    color: rgba(0,0,0,0.8);
    font-size: 0.9em;
    padding-bottom: 1em;
    margin-bottom: 1em;
    padding-bottom: 0.5em;
    margin-bottom: 1em;
    padding-left: 0.25em;
    justify-self: start;
  }

  @media(min-width: 1000px) {
    .d-contents.d-contents-float {
      height: 0;
      grid-column-start: 1;
      grid-column-end: 4;
      justify-self: center;
      padding-right: 3em;
      padding-left: 2em;
    }
  }

  .d-contents nav h3 {
    font-size: 18px;
    margin-top: 0;
    margin-bottom: 1em;
  }

  .d-contents li {
    list-style-type: none
  }

  .d-contents nav > ul {
    padding-left: 0;
  }

  .d-contents ul {
    padding-left: 1em
  }

  .d-contents nav ul li {
    margin-top: 0.6em;
    margin-bottom: 0.2em;
  }

  .d-contents nav a {
    font-size: 13px;
    border-bottom: none;
    text-decoration: none
    color: rgba(0, 0, 0, 0.8);
  }

  .d-contents nav a:hover {
    text-decoration: underline solid rgba(0, 0, 0, 0.6)
  }

  .d-contents nav > ul > li > a {
    font-weight: 600;
  }

  .d-contents nav > ul > li > ul {
    font-weight: inherit;
  }

  .d-contents nav > ul > li > ul > li {
    margin-top: 0.2em;
  }


  .d-contents nav ul {
    margin-top: 0;
    margin-bottom: 0.25em;
  }

  .d-article-with-toc h2:nth-child(2) {
    margin-top: 0;
  }


  /* Figure */

  .figure {
    position: relative;
    margin-bottom: 2.5em;
    margin-top: 1.5em;
  }

  .figure .caption {
    color: rgba(0, 0, 0, 0.6);
    font-size: 12px;
    line-height: 1.5em;
  }

  .figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }

  .figure .caption a {
    color: rgba(0, 0, 0, 0.6);
  }

  .figure .caption b,
  .figure .caption strong, {
    font-weight: 600;
    color: rgba(0, 0, 0, 1.0);
  }

  /* Citations */

  d-article .citation {
    color: inherit;
    cursor: inherit;
  }

  div.hanging-indent{
    margin-left: 1em; text-indent: -1em;
  }

  /* Citation hover box */

  .tippy-box[data-theme~=light-border] {
    background-color: rgba(250, 250, 250, 0.95);
  }

  .tippy-content > p {
    margin-bottom: 0;
    padding: 2px;
  }


  /* Tweak 1000px media break to show more text */

  @media(min-width: 1000px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 80px [middle-start] 50px [text-start kicker-end] 65px 65px 65px 65px 65px 65px 65px 65px [text-end gutter-start] 65px [middle-end] 65px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 16px;
    }

    .grid {
      grid-column-gap: 16px;
    }

    d-article {
      font-size: 1.06rem;
      line-height: 1.7em;
    }
    figure .caption, .figure .caption, figure figcaption {
      font-size: 13px;
    }
  }

  @media(min-width: 1180px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 60px [middle-start] 60px [text-start kicker-end] 60px 60px 60px 60px 60px 60px 60px 60px [text-end gutter-start] 60px [middle-end] 60px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 32px;
    }

    .grid {
      grid-column-gap: 32px;
    }
  }


  /* Get the citation styles for the appendix (not auto-injected on render since
     we do our own rendering of the citation appendix) */

  d-appendix .citation-appendix,
  .d-appendix .citation-appendix {
    font-size: 11px;
    line-height: 15px;
    border-left: 1px solid rgba(0, 0, 0, 0.1);
    padding-left: 18px;
    border: 1px solid rgba(0,0,0,0.1);
    background: rgba(0, 0, 0, 0.02);
    padding: 10px 18px;
    border-radius: 3px;
    color: rgba(150, 150, 150, 1);
    overflow: hidden;
    margin-top: -12px;
    white-space: pre-wrap;
    word-wrap: break-word;
  }

  /* Include appendix styles here so they can be overridden */

  d-appendix {
    contain: layout style;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-top: 60px;
    margin-bottom: 0;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    color: rgba(0,0,0,0.5);
    padding-top: 60px;
    padding-bottom: 48px;
  }

  d-appendix h3 {
    grid-column: page-start / text-start;
    font-size: 15px;
    font-weight: 500;
    margin-top: 1em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.65);
  }

  d-appendix h3 + * {
    margin-top: 1em;
  }

  d-appendix ol {
    padding: 0 0 0 15px;
  }

  @media (min-width: 768px) {
    d-appendix ol {
      padding: 0 0 0 30px;
      margin-left: -30px;
    }
  }

  d-appendix li {
    margin-bottom: 1em;
  }

  d-appendix a {
    color: rgba(0, 0, 0, 0.6);
  }

  d-appendix > * {
    grid-column: text;
  }

  d-appendix > d-footnote-list,
  d-appendix > d-citation-list,
  d-appendix > distill-appendix {
    grid-column: screen;
  }

  /* Include footnote styles here so they can be overridden */

  d-footnote-list {
    contain: layout style;
  }

  d-footnote-list > * {
    grid-column: text;
  }

  d-footnote-list a.footnote-backlink {
    color: rgba(0,0,0,0.3);
    padding-left: 0.5em;
  }



  /* Anchor.js */

  .anchorjs-link {
    /*transition: all .25s linear; */
    text-decoration: none;
    border-bottom: none;
  }
  *:hover > .anchorjs-link {
    margin-left: -1.125em !important;
    text-decoration: none;
    border-bottom: none;
  }

  /* Social footer */

  .social_footer {
    margin-top: 30px;
    margin-bottom: 0;
    color: rgba(0,0,0,0.67);
  }

  .disqus-comments {
    margin-right: 30px;
  }

  .disqus-comment-count {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
    cursor: pointer;
  }

  #disqus_thread {
    margin-top: 30px;
  }

  .article-sharing a {
    border-bottom: none;
    margin-right: 8px;
  }

  .article-sharing a:hover {
    border-bottom: none;
  }

  .sidebar-section.subscribe {
    font-size: 12px;
    line-height: 1.6em;
  }

  .subscribe p {
    margin-bottom: 0.5em;
  }


  .article-footer .subscribe {
    font-size: 15px;
    margin-top: 45px;
  }


  .sidebar-section.custom {
    font-size: 12px;
    line-height: 1.6em;
  }

  .custom p {
    margin-bottom: 0.5em;
  }

  /* Styles for listing layout (hide title) */
  .layout-listing d-title, .layout-listing .d-title {
    display: none;
  }

  /* Styles for posts lists (not auto-injected) */


  .posts-with-sidebar {
    padding-left: 45px;
    padding-right: 45px;
  }

  .posts-list .description h2,
  .posts-list .description p {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  }

  .posts-list .description h2 {
    font-weight: 700;
    border-bottom: none;
    padding-bottom: 0;
  }

  .posts-list h2.post-tag {
    border-bottom: 1px solid rgba(0, 0, 0, 0.2);
    padding-bottom: 12px;
  }
  .posts-list {
    margin-top: 60px;
    margin-bottom: 24px;
  }

  .posts-list .post-preview {
    text-decoration: none;
    overflow: hidden;
    display: block;
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
    padding: 24px 0;
  }

  .post-preview-last {
    border-bottom: none !important;
  }

  .posts-list .posts-list-caption {
    grid-column: screen;
    font-weight: 400;
  }

  .posts-list .post-preview h2 {
    margin: 0 0 6px 0;
    line-height: 1.2em;
    font-style: normal;
    font-size: 24px;
  }

  .posts-list .post-preview p {
    margin: 0 0 12px 0;
    line-height: 1.4em;
    font-size: 16px;
  }

  .posts-list .post-preview .thumbnail {
    box-sizing: border-box;
    margin-bottom: 24px;
    position: relative;
    max-width: 500px;
  }
  .posts-list .post-preview img {
    width: 100%;
    display: block;
  }

  .posts-list .metadata {
    font-size: 12px;
    line-height: 1.4em;
    margin-bottom: 18px;
  }

  .posts-list .metadata > * {
    display: inline-block;
  }

  .posts-list .metadata .publishedDate {
    margin-right: 2em;
  }

  .posts-list .metadata .dt-authors {
    display: block;
    margin-top: 0.3em;
    margin-right: 2em;
  }

  .posts-list .dt-tags {
    display: block;
    line-height: 1em;
  }

  .posts-list .dt-tags .dt-tag {
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0.3em 0.4em;
    margin-right: 0.2em;
    margin-bottom: 0.4em;
    font-size: 60%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }

  .posts-list img {
    opacity: 1;
  }

  .posts-list img[data-src] {
    opacity: 0;
  }

  .posts-more {
    clear: both;
  }


  .posts-sidebar {
    font-size: 16px;
  }

  .posts-sidebar h3 {
    font-size: 16px;
    margin-top: 0;
    margin-bottom: 0.5em;
    font-weight: 400;
    text-transform: uppercase;
  }

  .sidebar-section {
    margin-bottom: 30px;
  }

  .categories ul {
    list-style-type: none;
    margin: 0;
    padding: 0;
  }

  .categories li {
    color: rgba(0, 0, 0, 0.8);
    margin-bottom: 0;
  }

  .categories li>a {
    border-bottom: none;
  }

  .categories li>a:hover {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
  }

  .categories .active {
    font-weight: 600;
  }

  .categories .category-count {
    color: rgba(0, 0, 0, 0.4);
  }


  @media(min-width: 768px) {
    .posts-list .post-preview h2 {
      font-size: 26px;
    }
    .posts-list .post-preview .thumbnail {
      float: right;
      width: 30%;
      margin-bottom: 0;
    }
    .posts-list .post-preview .description {
      float: left;
      width: 45%;
    }
    .posts-list .post-preview .metadata {
      float: left;
      width: 20%;
      margin-top: 8px;
    }
    .posts-list .post-preview p {
      margin: 0 0 12px 0;
      line-height: 1.5em;
      font-size: 16px;
    }
    .posts-with-sidebar .posts-list {
      float: left;
      width: 75%;
    }
    .posts-with-sidebar .posts-sidebar {
      float: right;
      width: 20%;
      margin-top: 60px;
      padding-top: 24px;
      padding-bottom: 24px;
    }
  }


  /* Improve display for browsers without grid (IE/Edge <= 15) */

  .downlevel {
    line-height: 1.6em;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
    margin: 0;
  }

  .downlevel .d-title {
    padding-top: 6rem;
    padding-bottom: 1.5rem;
  }

  .downlevel .d-title h1 {
    font-size: 50px;
    font-weight: 700;
    line-height: 1.1em;
    margin: 0 0 0.5rem;
  }

  .downlevel .d-title p {
    font-weight: 300;
    font-size: 1.2rem;
    line-height: 1.55em;
    margin-top: 0;
  }

  .downlevel .d-byline {
    padding-top: 0.8em;
    padding-bottom: 0.8em;
    font-size: 0.8rem;
    line-height: 1.8em;
  }

  .downlevel .section-separator {
    border: none;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
  }

  .downlevel .d-article {
    font-size: 1.06rem;
    line-height: 1.7em;
    padding-top: 1rem;
    padding-bottom: 2rem;
  }


  .downlevel .d-appendix {
    padding-left: 0;
    padding-right: 0;
    max-width: none;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.5);
    padding-top: 40px;
    padding-bottom: 48px;
  }

  .downlevel .footnotes ol {
    padding-left: 13px;
  }

  .downlevel .base-grid,
  .downlevel .distill-header,
  .downlevel .d-title,
  .downlevel .d-abstract,
  .downlevel .d-article,
  .downlevel .d-appendix,
  .downlevel .distill-appendix,
  .downlevel .d-byline,
  .downlevel .d-footnote-list,
  .downlevel .d-citation-list,
  .downlevel .distill-footer,
  .downlevel .appendix-bottom,
  .downlevel .posts-container {
    padding-left: 40px;
    padding-right: 40px;
  }

  @media(min-width: 768px) {
    .downlevel .base-grid,
    .downlevel .distill-header,
    .downlevel .d-title,
    .downlevel .d-abstract,
    .downlevel .d-article,
    .downlevel .d-appendix,
    .downlevel .distill-appendix,
    .downlevel .d-byline,
    .downlevel .d-footnote-list,
    .downlevel .d-citation-list,
    .downlevel .distill-footer,
    .downlevel .appendix-bottom,
    .downlevel .posts-container {
    padding-left: 150px;
    padding-right: 150px;
    max-width: 900px;
  }
  }

  .downlevel pre code {
    display: block;
    border-left: 2px solid rgba(0, 0, 0, .1);
    padding: 0 0 0 20px;
    font-size: 14px;
  }

  .downlevel code, .downlevel pre {
    color: black;
    background: none;
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;

    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;

    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }

  .downlevel .posts-list .post-preview {
    color: inherit;
  }



  </style>

  <script type="application/javascript">

  function is_downlevel_browser() {
    if (bowser.isUnsupportedBrowser({ msie: "12", msedge: "16"},
                                   window.navigator.userAgent)) {
      return true;
    } else {
      return window.load_distill_framework === undefined;
    }
  }

  // show body when load is complete
  function on_load_complete() {

    // add anchors
    if (window.anchors) {
      window.anchors.options.placement = 'left';
      window.anchors.add('d-article > h2, d-article > h3, d-article > h4, d-article > h5');
    }


    // set body to visible
    document.body.style.visibility = 'visible';

    // force redraw for leaflet widgets
    if (window.HTMLWidgets) {
      var maps = window.HTMLWidgets.findAll(".leaflet");
      $.each(maps, function(i, el) {
        var map = this.getMap();
        map.invalidateSize();
        map.eachLayer(function(layer) {
          if (layer instanceof L.TileLayer)
            layer.redraw();
        });
      });
    }

    // trigger 'shown' so htmlwidgets resize
    $('d-article').trigger('shown');
  }

  function init_distill() {

    init_common();

    // create front matter
    var front_matter = $('<d-front-matter></d-front-matter>');
    $('#distill-front-matter').wrap(front_matter);

    // create d-title
    $('.d-title').changeElementType('d-title');

    // create d-byline
    var byline = $('<d-byline></d-byline>');
    $('.d-byline').replaceWith(byline);

    // create d-article
    var article = $('<d-article></d-article>');
    $('.d-article').wrap(article).children().unwrap();

    // move posts container into article
    $('.posts-container').appendTo($('d-article'));

    // create d-appendix
    $('.d-appendix').changeElementType('d-appendix');

    // flag indicating that we have appendix items
    var appendix = $('.appendix-bottom').children('h3').length > 0;

    // replace footnotes with <d-footnote>
    $('.footnote-ref').each(function(i, val) {
      appendix = true;
      var href = $(this).attr('href');
      var id = href.replace('#', '');
      var fn = $('#' + id);
      var fn_p = $('#' + id + '>p');
      fn_p.find('.footnote-back').remove();
      var text = fn_p.html();
      var dtfn = $('<d-footnote></d-footnote>');
      dtfn.html(text);
      $(this).replaceWith(dtfn);
    });
    // remove footnotes
    $('.footnotes').remove();

    // move refs into #references-listing
    $('#references-listing').replaceWith($('#refs'));

    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      var id = $(this).attr('id');
      $('.d-contents a[href="#' + id + '"]').parent().remove();
      appendix = true;
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('d-appendix'));
    });

    // show d-appendix if we have appendix content
    $("d-appendix").css('display', appendix ? 'grid' : 'none');

    // localize layout chunks to just output
    $('.layout-chunk').each(function(i, val) {

      // capture layout
      var layout = $(this).attr('data-layout');

      // apply layout to markdown level block elements
      var elements = $(this).children().not('details, div.sourceCode, pre, script');
      elements.each(function(i, el) {
        var layout_div = $('<div class="' + layout + '"></div>');
        if (layout_div.hasClass('shaded')) {
          var shaded_content = $('<div class="shaded-content"></div>');
          $(this).wrap(shaded_content);
          $(this).parent().wrap(layout_div);
        } else {
          $(this).wrap(layout_div);
        }
      });


      // unwrap the layout-chunk div
      $(this).children().unwrap();
    });

    // remove code block used to force  highlighting css
    $('.distill-force-highlighting-css').parent().remove();

    // remove empty line numbers inserted by pandoc when using a
    // custom syntax highlighting theme
    $('code.sourceCode a:empty').remove();

    // load distill framework
    load_distill_framework();

    // wait for window.distillRunlevel == 4 to do post processing
    function distill_post_process() {

      if (!window.distillRunlevel || window.distillRunlevel < 4)
        return;

      // hide author/affiliations entirely if we have no authors
      var front_matter = JSON.parse($("#distill-front-matter").html());
      var have_authors = front_matter.authors && front_matter.authors.length > 0;
      if (!have_authors)
        $('d-byline').addClass('hidden');

      // article with toc class
      $('.d-contents').parent().addClass('d-article-with-toc');

      // strip links that point to #
      $('.authors-affiliations').find('a[href="#"]').removeAttr('href');

      // add orcid ids
      $('.authors-affiliations').find('.author').each(function(i, el) {
        var orcid_id = front_matter.authors[i].orcidID;
        if (orcid_id) {
          var a = $('<a></a>');
          a.attr('href', 'https://orcid.org/' + orcid_id);
          var img = $('<img></img>');
          img.addClass('orcid-id');
          img.attr('alt', 'ORCID ID');
          img.attr('src','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg==');
          a.append(img);
          $(this).append(a);
        }
      });

      // hide elements of author/affiliations grid that have no value
      function hide_byline_column(caption) {
        $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'hidden');
      }

      // affiliations
      var have_affiliations = false;
      for (var i = 0; i<front_matter.authors.length; ++i) {
        var author = front_matter.authors[i];
        if (author.affiliation !== "&nbsp;") {
          have_affiliations = true;
          break;
        }
      }
      if (!have_affiliations)
        $('d-byline').find('h3:contains("Affiliations")').css('visibility', 'hidden');

      // published date
      if (!front_matter.publishedDate)
        hide_byline_column("Published");

      // document object identifier
      var doi = $('d-byline').find('h3:contains("DOI")');
      var doi_p = doi.next().empty();
      if (!front_matter.doi) {
        // if we have a citation and valid citationText then link to that
        if ($('#citation').length > 0 && front_matter.citationText) {
          doi.html('Citation');
          $('<a href="#citation"></a>')
            .text(front_matter.citationText)
            .appendTo(doi_p);
        } else {
          hide_byline_column("DOI");
        }
      } else {
        $('<a></a>')
           .attr('href', "https://doi.org/" + front_matter.doi)
           .html(front_matter.doi)
           .appendTo(doi_p);
      }

       // change plural form of authors/affiliations
      if (front_matter.authors.length === 1) {
        var grid = $('.authors-affiliations');
        grid.children('h3:contains("Authors")').text('Author');
        grid.children('h3:contains("Affiliations")').text('Affiliation');
      }

      // remove d-appendix and d-footnote-list local styles
      $('d-appendix > style:first-child').remove();
      $('d-footnote-list > style:first-child').remove();

      // move appendix-bottom entries to the bottom
      $('.appendix-bottom').appendTo('d-appendix').children().unwrap();
      $('.appendix-bottom').remove();

      // hoverable references
      $('span.citation[data-cites]').each(function() {
        const citeChild = $(this).children()[0]
        // Do not process if @xyz has been used without escaping and without bibliography activated
        // https://github.com/rstudio/distill/issues/466
        if (citeChild === undefined) return true

        if (citeChild.nodeName == "D-FOOTNOTE") {
          var fn = citeChild
          $(this).html(fn.shadowRoot.querySelector("sup"))
          $(this).id = fn.id
          fn.remove()
        }
        var refs = $(this).attr('data-cites').split(" ");
        var refHtml = refs.map(function(ref) {
          // Could use CSS.escape too here, we insure backward compatibility in navigator
          return "<p>" + $('div[id="ref-' + ref + '"]').html() + "</p>";
        }).join("\n");
        window.tippy(this, {
          allowHTML: true,
          content: refHtml,
          maxWidth: 500,
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start'
        });
      });

      // fix footnotes in tables (#411)
      // replacing broken distill.pub feature
      $('table d-footnote').each(function() {
        // we replace internal showAtNode methode which is triggered when hovering a footnote
        this.hoverBox.showAtNode = function(node) {
          // ported from https://github.com/distillpub/template/pull/105/files
          calcOffset = function(elem) {
              let x = elem.offsetLeft;
              let y = elem.offsetTop;
              // Traverse upwards until an `absolute` element is found or `elem`
              // becomes null.
              while (elem = elem.offsetParent && elem.style.position != 'absolute') {
                  x += elem.offsetLeft;
                  y += elem.offsetTop;
              }

              return { left: x, top: y };
          }
          // https://developer.mozilla.org/en-US/docs/Web/API/HTMLElement/offsetTop
          const bbox = node.getBoundingClientRect();
          const offset = calcOffset(node);
          this.show([offset.left + bbox.width, offset.top + bbox.height]);
        }
      })

      // clear polling timer
      clearInterval(tid);

      // show body now that everything is ready
      on_load_complete();
    }

    var tid = setInterval(distill_post_process, 50);
    distill_post_process();

  }

  function init_downlevel() {

    init_common();

     // insert hr after d-title
    $('.d-title').after($('<hr class="section-separator"/>'));

    // check if we have authors
    var front_matter = JSON.parse($("#distill-front-matter").html());
    var have_authors = front_matter.authors && front_matter.authors.length > 0;

    // manage byline/border
    if (!have_authors)
      $('.d-byline').remove();
    $('.d-byline').after($('<hr class="section-separator"/>'));
    $('.d-byline a').remove();

    // remove toc
    $('.d-contents').remove();

    // move appendix elements
    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('.d-appendix'));
    });


    // inject headers into references and footnotes
    var refs_header = $('<h3></h3>');
    refs_header.text('References');
    $('#refs').prepend(refs_header);

    var footnotes_header = $('<h3></h3');
    footnotes_header.text('Footnotes');
    $('.footnotes').children('hr').first().replaceWith(footnotes_header);

    // move appendix-bottom entries to the bottom
    $('.appendix-bottom').appendTo('.d-appendix').children().unwrap();
    $('.appendix-bottom').remove();

    // remove appendix if it's empty
    if ($('.d-appendix').children().length === 0)
      $('.d-appendix').remove();

    // prepend separator above appendix
    $('.d-appendix').before($('<hr class="section-separator" style="clear: both"/>'));

    // trim code
    $('pre>code').each(function(i, val) {
      $(this).html($.trim($(this).html()));
    });

    // move posts-container right before article
    $('.posts-container').insertBefore($('.d-article'));

    $('body').addClass('downlevel');

    on_load_complete();
  }


  function init_common() {

    // jquery plugin to change element types
    (function($) {
      $.fn.changeElementType = function(newType) {
        var attrs = {};

        $.each(this[0].attributes, function(idx, attr) {
          attrs[attr.nodeName] = attr.nodeValue;
        });

        this.replaceWith(function() {
          return $("<" + newType + "/>", attrs).append($(this).contents());
        });
      };
    })(jQuery);

    // prevent underline for linked images
    $('a > img').parent().css({'border-bottom' : 'none'});

    // mark non-body figures created by knitr chunks as 100% width
    $('.layout-chunk').each(function(i, val) {
      var figures = $(this).find('img, .html-widget');
      // ignore leaflet img layers (#106)
      figures = figures.filter(':not(img[class*="leaflet"])')
      if ($(this).attr('data-layout') !== "l-body") {
        figures.css('width', '100%');
      } else {
        figures.css('max-width', '100%');
        figures.filter("[width]").each(function(i, val) {
          var fig = $(this);
          fig.css('width', fig.attr('width') + 'px');
        });

      }
    });

    // auto-append index.html to post-preview links in file: protocol
    // and in rstudio ide preview
    $('.post-preview').each(function(i, val) {
      if (window.location.protocol === "file:")
        $(this).attr('href', $(this).attr('href') + "index.html");
    });

    // get rid of index.html references in header
    if (window.location.protocol !== "file:") {
      $('.distill-site-header a[href]').each(function(i,val) {
        $(this).attr('href', $(this).attr('href').replace(/^index[.]html/, "./"));
      });
    }

    // add class to pandoc style tables
    $('tr.header').parent('thead').parent('table').addClass('pandoc-table');
    $('.kable-table').children('table').addClass('pandoc-table');

    // add figcaption style to table captions
    $('caption').parent('table').addClass("figcaption");

    // initialize posts list
    if (window.init_posts_list)
      window.init_posts_list();

    // implmement disqus comment link
    $('.disqus-comment-count').click(function() {
      window.headroom_prevent_pin = true;
      $('#disqus_thread').toggleClass('hidden');
      if (!$('#disqus_thread').hasClass('hidden')) {
        var offset = $(this).offset();
        $(window).resize();
        $('html, body').animate({
          scrollTop: offset.top - 35
        });
      }
    });
  }

  document.addEventListener('DOMContentLoaded', function() {
    if (is_downlevel_browser())
      init_downlevel();
    else
      window.addEventListener('WebComponentsReady', init_distill);
  });

  </script>

  <!--/radix_placeholder_distill-->
  <script src="index_files/header-attrs-2.16/header-attrs.js"></script>
  <script src="index_files/jquery-3.6.0/jquery-3.6.0.min.js"></script>
  <script src="index_files/popper-2.6.0/popper.min.js"></script>
  <link href="index_files/tippy-6.2.7/tippy.css" rel="stylesheet" />
  <link href="index_files/tippy-6.2.7/tippy-light-border.css" rel="stylesheet" />
  <script src="index_files/tippy-6.2.7/tippy.umd.min.js"></script>
  <script src="index_files/anchor-4.2.2/anchor.min.js"></script>
  <script src="index_files/bowser-1.9.3/bowser.min.js"></script>
  <script src="index_files/webcomponents-2.0.0/webcomponents.js"></script>
  <script src="index_files/distill-2.2.21/template.v2.js"></script>
  <!--radix_placeholder_site_in_header-->
  <!--/radix_placeholder_site_in_header-->


</head>

<body>

<!--radix_placeholder_front_matter-->

<script id="distill-front-matter" type="text/json">
{"title":"Modeling false-positive detections through a count-detection framework: literature review","description":"A review of false positive occupancy modeling (mostly) after 2020","authors":[{"author":"Jacob Oram","authorURL":"#","affiliation":"Montana State University","affiliationURL":"https://math.montana.edu/","orcidID":""}],"publishedDate":"2022-12-13T00:00:00.000-07:00","citationText":"Oram, 2022"}
</script>

<!--/radix_placeholder_front_matter-->
<!--radix_placeholder_navigation_before_body-->
<!--/radix_placeholder_navigation_before_body-->
<!--radix_placeholder_site_before_body-->
<!--/radix_placeholder_site_before_body-->

<div class="d-title">
<h1>Modeling false-positive detections through a count-detection framework: literature review</h1>
<!--radix_placeholder_categories-->
<!--/radix_placeholder_categories-->
<p><p>A review of false positive occupancy modeling (mostly) after 2020</p></p>
</div>

<div class="d-byline">
  Jacob Oram  (Montana State University)<a href="https://math.montana.edu/" class="uri">https://math.montana.edu/</a>
  
<br/>2022-12-13
</div>

<div class="d-article">
<div class="d-contents d-contents-float">
<nav class="l-text toc figcaption" id="TOC">
<h3>Contents</h3>
<ul>
<li><a href="#annotated-bibliography" id="toc-annotated-bibliography">Annotated Bibliography</a>
<ul>
<li><a href="#section" id="toc-section">2017</a></li>
<li><a href="#section-1" id="toc-section-1">2018</a></li>
<li><a href="#section-2" id="toc-section-2">2020</a></li>
<li><a href="#section-3" id="toc-section-3">2021</a></li>
<li><a href="#section-4" id="toc-section-4">2022</a></li>
</ul></li>
</ul>
</nav>
</div>
<h1 id="annotated-bibliography">Annotated Bibliography</h1>
<h2 id="section">2017</h2>
<h3 id="ga17b-dealing-with-false-positive-and-false-negative-errors-about-species-occurrence-at-multiple-levels"><span class="citation" data-cites="ga17b">(<a href="#ref-ga17b" role="doc-biblioref">Guillera-Arroita et al., 2017</a>)</span> Dealing with false-positive and false-negative errors about species occurrence at multiple levels</h3>
<h4 id="summary">Summary</h4>
<p>The authors develop a false-positive occupancy model that has multiple stages.
The motivating example is use of eDNA gathered from water and analyzed via PCR to determine the presence or absence of a species of interest.
At each site, the species may or may not be present, its eDNA may or may not be available for detection, and the lab equipment may or may not detect the eDNA.
This example assumes that multiple primary and secondary sampling occasions are used in the design (e.g., multiple water samples from multiple visits to a site).
After discussing identifiability in models such as these, the authors investigate which sources of auxiliary data are most useful for identifying parameters, comparing unambiguous detections (U), calibration experiments across the two stages (C1) and calibration experiments at the lower stage (detection level).
This auxiliary information is incorporated into the likelihood via the extended model below.
The authors apply their extended model to an eDNA survey of four frog species, where aural surveys were included as unambiguous detections; results indicate that combining unambiguous data with calibration data for <span class="math inline">\(p_{10}\)</span> or using both sources of calibration data were sufficient for identifying the model.
The authors conclude with a discussion of future applications, connections to existing models, and the advantages of using profile likelihoods to characterize uncertainty and and find multimodality in the likelihood function.</p>
<h4 id="model-specification">Model specification</h4>
<p>Let</p>
<ul>
<li><span class="math inline">\(\psi\)</span> denote occupancy of the focal species.</li>
<li><span class="math inline">\(\theta_{11}\)</span> denote the probability that the species is “available for detection”, given that it is present.</li>
<li><span class="math inline">\(\theta_{10}\)</span> denote the probability that the species is “available for detection”, given that it is <em>not</em> present. This might happen in eDNA through contamination of equipment in the field.</li>
<li><span class="math inline">\(p_{11}\)</span> denote the probability that the species is detected, given that it is available for detection.</li>
<li><span class="math inline">\(p_{10}\)</span> denote the probability that the species is detected, given that it is not available for detection.</li>
</ul>
<p>Then, the likelihood of the “core model” may be written as
<span class="math display">\[
L = \prod_i \left[\psi_i \left(\prod_j \left(\theta_{11} \prod_l^{L_{ij}} p_{11}^{d_{ijl}} (1- p_{11})^{1 - d_{ijl}} + (1-\theta_{11})  \prod_l^{L_{ij}} p_{10}^{d_{ijl}} (1- p_{10})^{1 - d_{ijl}} \right)\right) + \\ (1-\psi_i) \left(\prod_j \left(\theta_{10} \prod_l^{L_{ij}} p_{11}^{d_{ijl}} (1- p_{11})^{1 - d_{ijl}} + (1-\theta_{10})  \prod_l^{L_{ij}} p_{10}^{d_{ijl}} (1- p_{10})^{1 - d_{ijl}} \right)\right)\right],
\]</span></p>
<p>where <span class="math inline">\(d_{ijl}\)</span> is the detection/non-detection of the focal species on secondary sampling occasion <span class="math inline">\(l\)</span>, primary sampling occasion <span class="math inline">\(j\)</span> to site <span class="math inline">\(i\)</span>. <span class="math inline">\(L_{ij}\)</span> is the number of secondary sampling occasions at site <span class="math inline">\(i\)</span> on primary sampling occasion <span class="math inline">\(j\)</span>.</p>
<p>For the extended model, the bernoulli trials for detections within secondary sapling occassions <span class="math inline">\(l\)</span> are collapsed to binomial random variables so that <span class="math inline">\(d_{ij}\)</span> in the extended model is the sum of <span class="math inline">\(d_{ij}\)</span> values in the core model above. The extended model requires additional notation to describe the joint likelihood of both auxiliary and experimental data. Let</p>
<ul>
<li><span class="math inline">\(K_i\)</span> be the number of replicates used with the unambiguous method</li>
<li><span class="math inline">\(\delta_i\)</span> be the number of detections from the unambiguous method</li>
<li><span class="math inline">\(r_{11}\)</span> denote the probability of detection with the unambiguous method</li>
<li><span class="math inline">\(V^{c1}\)</span> denote the the number of trials in the calibration experiment at the level of the primary sampling occasion.</li>
<li><span class="math inline">\(L_{j}^{c1}\)</span> and <span class="math inline">\(d_j^{c1}\)</span> denote the number of replicates and detections, respectively, in a “blank” water sample <span class="math inline">\(j\)</span> (i.e., in the primary sampling occasion).</li>
<li><span class="math inline">\(L^{c2}\)</span> and <span class="math inline">\(d^{c2}\)</span> denote the number of blanks and detections in the calibration experiment at the secondary sampling level. In the eDNA example, these are the number of blank PCRs and detections within a water sample.</li>
</ul>
<p>With this notation, the extended model that accommodates auxiliary data has the likelihood <span class="math display">\[
L = \prod_i \left[\psi_i \left( \prod_j^{V_i} \left( \theta_{11} p_{11}^{d_{ij}}(1 - p_{11})^{L_{ij} - d_{ij}} + (1 - \theta_{11}) p_{10}^{d_{ij}}(1 - p_{10})^{L_{ij} - d_{ij}}
\right)
\right) \{r_{11}^{\delta_i}(1 - r_{11})^{K_i - \delta_i}\} + \\
(1- \psi_i) \left(
\prod_j^{V_i} \left( \theta_{10} p_{11}^{d_{ij}}(1 - p_{11})^{L_{ij} - d_{ij}} + (1 - \theta_{10}) p_{10}^{d_{ij}}(1 - p_{10})^{L_{ij} - d_{ij}}
\right)
\right) \{0^{\delta_i}\}
\right] \times \\
\prod_{j = 1}^{V^{c1}} \left(
\theta_{10} p_{11}^{d_j^{c1}}(1-p_{11})^{L_j^{c1} - d_j^{c1}} + (1- \theta_{10})p_{10}^{d_j^{c1}}(1-p_{10})^{L_j^{c1} - d_j^{c1}}
\right) \times \\
\left[
p_{10}^{d_j^{c2}}(1-p_{10})^{L^{c2} - d^{c2}}
\right]
\]</span></p>
<p>A more intuitive way of writing the extended model is hierarchically:</p>
<p><span class="math display">\[
z_i^1 \sim Bernoulli(\psi_i)\\
z_{ij}^2 \sim Bernoulli(z_i^1 \theta_{11} + (1-z_i^1)\theta_{10})\\
d_{ij} \sim Binomial(L_{ij}, z_{ij}^2 p_{11} + (1- z_{ij}^2) p_{10})\\
\delta_i \sim Binomial(K_i, z_i^1 r_{11})\\
z_j^{2, c1} \sim Bernoulli(\theta_{10})\\
d_j^{c1} \sim Binomial (L_j^{c1}, z_j^{2,c1} p_{11} + (1 - z_j^{2,c1})p_{10})\\
d^{c2} \sim Binomial (L^{c2}, p_{10})
\]</span></p>
<h4 id="notes">Notes</h4>
<ul>
<li>The authors introduce the profile log-likelihood and use it for estimation. The profile likelihood is described by the authors as (for some parameter <span class="math inline">\(\phi\)</span> in the model) “the value of the likelihood function for each value of <span class="math inline">\(\phi\)</span> maximized with respect to the other parameters.</li>
<li>This study was conducted entirely within an MLE framework, but the authors acknowledge that it is possible to identify parameters using prior knowledge in a Bayesian paradigm.</li>
</ul>
<h3 id="ga17-species-occupancy-estimation-and-imperfect-detection-shall-surveys-continue-after-the-first-detection"><span class="citation" data-cites="ga17">(<a href="#ref-ga17" role="doc-biblioref">Guillera-Arroita and Lahoz-Monfort, 2017</a>)</span> Species occupancy estimation and imperfect detection: shall surveys continue after the first detection?</h3>
<h4 id="summary-1">Summary</h4>
<p>The authors compare a removal design (where sites are no longer visited after first detection of the focal species) to a standard design in an occupancy modeling framework.
The authors do so first by assessing relative efficiency (in terms of the ratio of RMSE for the two designs) when occupancy and detection probabilities are assumed constant.
Under these constraints, they find that the removal design is more efficient when the detection probability and number of visits made to a site are not small, and when conditions are optimal; if these requirements are not satisfied, the standard design performs better.
When assuming constant occupancy and detection probabilities, the authors use simulation to investigate the impacts of decreased survey effort, finding that the removal design is much more sensitive.
When occupancy and detection probabilities are heterogeneous, the authors find that analytically, bias is identical for the two designs.
Simulations indicate that in the presence of unmodelled detection probability heterogeneity, the standard design outperforms the removal design when cumulative detection probability is not nearly 1.
If the heterogeneity <em>is</em> modelled, however, the standard design outperforms the removal design because it provides more opportunities to gather covariate information to model the heterogeneity.</p>
<h4 id="model-specification-1">Model Specification</h4>
<p>Let <span class="math inline">\(\psi\)</span> denote the probability that site <span class="math inline">\(i\)</span> is occupied by the focal species, and let <span class="math inline">\(p_i\)</span> denote the probability of detecting the focal species at an occupied site <span class="math inline">\(i.\)</span> Furthermore, let</p>
<ul>
<li><span class="math inline">\(S\)</span> denote the number of sites sampled</li>
<li><span class="math inline">\(S_d\)</span> denote the number of sites where a detection occurred</li>
<li><span class="math inline">\(K_i\)</span> denote the number of visits to made to site <span class="math inline">\(i.\)</span> Under the removal design, this is a random variable.</li>
<li><span class="math inline">\(K_M\)</span> denote the designed number of visits to each site</li>
<li><span class="math inline">\(d_i\)</span> denote the number of detections at site <span class="math inline">\(i\)</span></li>
<li><span class="math inline">\(p_i^\star\)</span> denote the cumulative probability of a detection after <span class="math inline">\(K_M\)</span> visits (<span class="math inline">\(p_i^\star = 1 - (1-p_i)^{K_M}\)</span>)</li>
<li><span class="math inline">\(n_1\)</span> denote the total number of detections</li>
<li><span class="math inline">\(n_0\)</span> denote the number of non-detections</li>
</ul>
<p>Under the standard occupancy model, the likelihood is</p>
<p><span class="math display">\[
\mathcal{L}(\boldsymbol{\psi}, \boldsymbol{p}) = \prod_{i = 1}^S \left[ \psi_i p_i^{d_i} (1-p_i)^{K_i - d_i} + I(d_i = 0)(1-\psi_i) \right].
\]</span></p>
<p>For the removal design, and assuming that <span class="math inline">\(\psi\)</span> and <span class="math inline">\([\)</span> are constant, the likelihood can be rewritten as</p>
<p><span class="math display">\[
\mathcal{L}(\psi, p) = \psi^{S_d} p^{n_1} (1-p)^{n_0 - (S-S_d)K_M} (1 - \psi p^\star)^{S - S_d}
\]</span></p>
<h2 id="section-1">2018</h2>
<h3 id="chambert18-a-new-framework-for-analysing-automated-acoustic-species-detection-data-occupancy-estimation-and-optimization-of-recordings-post-processing"><span class="citation" data-cites="chambert18">(<a href="#ref-chambert18" role="doc-biblioref">Chambert et al., 2018b</a>)</span> A new framework for analysing automated acoustic species detection data: Occupancy estimation and optimization of recordings post-processing</h3>
<h4 id="summary-2">Summary</h4>
<p>The authors propose framework that models partially-observed occupancy states with information from both binary and count detections; a subset of automatically labeled recordings are manually vetted and modeled using a hypergeometric distribution.
The authors demonstrate this model’s properties through simulation and compare the full model against two reduced models that use either solely binary detection information or solely count detection information.
The authors find that the general model performed better than either reduced model and that the reduced binary detection/non-detection model performed worst of the three considered in simulations.
Applying the general model to tree frog datasets where all calls were evaluated to be either true or false positives, the authors found that the general model was sensitive to outlier sites but was able to provide fairly accurate and precise estimates for occupancy probabilities when a greater proportion (12.5% and 5% (after outlier removal) for the two datasets respectively) of calls were evaluated as true- or false-positive detections.</p>
<h4 id="model-specification-2">Model specification</h4>
<p>Let <span class="math inline">\(i\)</span> index site and <span class="math inline">\(j\)</span> index visit. Then assume that</p>
<ul>
<li><span class="math inline">\(z_i\)</span> is the occupancy status of site <span class="math inline">\(i\)</span></li>
<li><span class="math inline">\(\psi_i\)</span> is the probability that site <span class="math inline">\(i\)</span> is occupied</li>
<li><span class="math inline">\(y_{ij}\)</span> is the binary detection/non detection observation recorded for site <span class="math inline">\(i\)</span> and visit <span class="math inline">\(j\)</span>.<br />
</li>
<li><span class="math inline">\(p_i\)</span> is the probability of detection at site <span class="math inline">\(i\)</span></li>
<li><span class="math inline">\(p_{11}\)</span> is the probability that the focal species is detected at a site given that it is present.</li>
<li><span class="math inline">\(p_{10}\)</span> is the probability that a detection is recorded, given that the focal species is not present.</li>
</ul>
<p>Then the false-positive occupancy portion of the model is written as</p>
<p><span class="math display">\[
z_i \sim Bernoulli(\psi_i)\\
[y_{ij}|z_i] \sim Bernoulli(p_i)\\
p_i = z_ip_{11} + (1-z_i)p_{10}\\
\]</span></p>
<p>For sites with at least one detection, let</p>
<ul>
<li><span class="math inline">\(N_i\)</span> denote the total number of detections at site <span class="math inline">\(i\)</span>.</li>
<li><span class="math inline">\(K_i\)</span> denote the number of true detections at site <span class="math inline">\(i\)</span>.</li>
<li><span class="math inline">\(Q_i\)</span> denote the number of false-positive detections at site <span class="math inline">\(i\)</span></li>
<li><span class="math inline">\(\lambda\)</span> be the expected number of true calls from the focal species</li>
<li><span class="math inline">\(\omega\)</span> be the expected number of false-positives, which are attributed to some exogenous, omnibus source <span class="citation" data-cites="wright20">(as opposed to the presence of another species as in <a href="#ref-wright20" role="doc-biblioref">Wright et al., 2020</a>)</span>.</li>
<li><span class="math inline">\(0 \leq n_i \leq N_i\)</span> denote the subset of calls recorded at site <span class="math inline">\(i\)</span> that are validated.</li>
<li><span class="math inline">\(k_i \leq n_i\)</span> denote the number of true positive recordings from the focal species.</li>
</ul>
<p>Then, the count detection and validation process is modeled as:</p>
<p><span class="math display">\[
N_i \sim Poisson(\lambda * z_i + \omega)\\
K_i \sim Poisson(\lambda z_i)\\
Q_i = N_i - K_i\\
k_i \sim Hypergeometric(K_i, N_i, n_i)
\]</span></p>
<h4 id="notes-1">Notes</h4>
<ul>
<li>This is a single-species model, as opposed to the multi-species model of <span class="citation" data-cites="wright20">Wright et al. (<a href="#ref-wright20" role="doc-biblioref">2020</a>)</span></li>
<li>A subset of calls are validated at a visit, in contrast with the assumption made by <span class="citation" data-cites="wright20">Wright et al. (<a href="#ref-wright20" role="doc-biblioref">2020</a>)</span> and <span class="citation" data-cites="stratton22">Stratton et al. (<a href="#ref-stratton22" role="doc-biblioref">2022</a>)</span></li>
</ul>
<h3 id="chambert18b-two-species-occupancy-modelling-accounting-for-species-misidentification-and-non-detection"><span class="citation" data-cites="chambert18b">(<a href="#ref-chambert18b" role="doc-biblioref">Chambert et al., 2018a</a>)</span> Two-species occupancy modelling accounting for species misidentification and non-detection</h3>
<h4 id="summary-3">Summary</h4>
<p>The authors develop a general approach to modeling false-positive errors when those false-positive error rates for one species are dependent on the presence of another.
The model that they propose considers two structures in how the two species interact in patterns of occurrence and co-occurrence : general and ‘dominance’ based interaction.
<span class="citation" data-cites="chambert18b">Chambert et al. (<a href="#ref-chambert18b" role="doc-biblioref">2018a</a>)</span> conduct a simulation study to investigate the influence of validation effort, which they call the proportion of confirmatory data (PCD).
In simulations, the model was able to recover parameters well (even for low PCD), but precision increased as PCD increased.
The authors also compared the performance of their model against the existing single-species model of Miller et al., (2011) (not included here).
The authors applied their model to two closely-related species of salamander where prior knowledge suggested a dominance interaction may be present.
In application to real data, the authors used the dynamic, multi-season model given in the appendix, but needed to reparameterize the model under the assumption that <span class="math inline">\(r = p\)</span> for both species (i.e., detection is independent of whether the other species is present) to obtain estimates and standard errors for several parameters.</p>
<h4 id="model-specification-3">Model specification</h4>
<p>Let <span class="math inline">\(i\)</span> index site, and <span class="math inline">\(j\)</span> index visit. Then let</p>
<ul>
<li><span class="math inline">\(y_{ij}\)</span> denote the field observation that takes on value A if only species A is observed, B if only species B is observed, AB if both are observed, and 0 if neither A nor B are recorded.</li>
<li><span class="math inline">\(Z_{ij}\)</span> denote the latent occupancy state. <span class="math inline">\(Z_{ij}\)</span> can take the same possible values as the field recordings: A, B, AB or 0.</li>
</ul>
<p>For the <em>general</em> model, let</p>
<ul>
<li><span class="math inline">\(\psi^A_i\)</span> and <span class="math inline">\(\psi^B_i\)</span> denote the unconditional probabilities of each species’ occurrence at site <span class="math inline">\(i\)</span>.<br />
</li>
<li><span class="math inline">\(\gamma\)</span> define the ‘species interaction factor’ that takes on value <span class="math inline">\(1\)</span> if there is no interaction (occurrence is independent), values <span class="math inline">\(&lt;1\)</span> if the two species tend to avoid one another, and values <span class="math inline">\(&gt;1\)</span> when they tend to co-occur.</li>
<li><span class="math inline">\(\psi^{AB}_i = \psi^A_i \times \psi^B_i \times \gamma\)</span> be the probability of occurrence</li>
<li><span class="math inline">\(\Phi = \begin{bmatrix} 1 - \psi^A - \psi^B + \psi^{AB} \\ \psi^A - \psi^{AB} \\ \psi^B - \psi^{AB} \\ \psi^{AB} \\ \end{bmatrix}\)</span> denote the vector of probabilities of occurrence. These are the probabilities of 0, A, B, and AB, respectively.</li>
</ul>
<p>For the <em>dominance interaction</em> model, occupancy of species A is independent of the presence or absence of the subordinate species B. Under this model, let</p>
<ul>
<li><span class="math inline">\(\psi^A_i\)</span> denote the unconditional probability that the dominant species is present at site <span class="math inline">\(i\)</span></li>
<li><span class="math inline">\(\psi^{B|a}\)</span> be the conditional probability that species <span class="math inline">\(B\)</span> is present, given that A is absent.</li>
<li><span class="math inline">\(\psi^{B|A}\)</span> denote the conditional probability that species <span class="math inline">\(B\)</span> is present given that <span class="math inline">\(A\)</span> is present. To be consistent with the general model, this can be rewritten as <span class="math inline">\(\psi^{B|A} = \psi^{B|a} \times \gamma\)</span></li>
<li><span class="math inline">\(\gamma\)</span> be the effect that the presence of species A has on the probability of presence for species B. <span class="math inline">\(\gamma &lt; 1 \implies\)</span> negative effect, <span class="math inline">\(\gamma = 1 \implies\)</span> no effect and <span class="math inline">\(\gamma &gt;1 \implies\)</span> a positive effect.</li>
<li><span class="math inline">\(\Phi = \begin{bmatrix} (1 - \psi^A)(1 - \psi^{B|a})\\ \psi^A (1 - \psi^{B|A})\\ (1- \psi^A) \psi^{B|a}\\ \psi^A \psi^{B|A}\end{bmatrix}\)</span> denote the vector of state probabilities. The entries correspond to 0, A, B, and AB, respectively.</li>
</ul>
<p>For the observation processes in both models, let</p>
<ul>
<li><span class="math inline">\(p^A\)</span> denote the probability of correctly detecting species A at a site where it is truly present.</li>
<li><span class="math inline">\(r^A\)</span> denote the probability of correctly detecting species A at a site where both species are present.</li>
<li><span class="math inline">\(\omega^A\)</span> denote the probability of recording a false-positive detection for species <strong>B</strong>, given that only species A is present, <em>and</em> other detections at the site visit have already correctly identified species A.</li>
<li><span class="math inline">\(\omega^a\)</span> denote the probability of recording a false-positive detection for species B, given that only species A is present and other detections at the site visit have <em>not</em> already correctly identified species A.</li>
<li><span class="math inline">\(\Pi_z\)</span> denote the probability vector corresponding to true occupancy state <span class="math inline">\(z.\)</span></li>
</ul>
<p>With this notation, the two-species occupancy model is
<span class="math display">\[
Z_i \sim Multinomial(\Phi)\\
y_{ij}|z_i \sim Multinomial(\Pi_{z_i}) \\
\]</span></p>
<p>with <span class="math inline">\(\Pi_{z_i}\)</span> specified as below, depending on the true state <span class="math inline">\(z_i\)</span>:</p>
<div class="layout-chunk" data-layout="l-body">
<p><img src="Pi.png" width="701" style="display: block; margin: auto;" /></p>
</div>
<p>For confirmatory data, let <span class="math inline">\(w_{ij}\)</span> denote the state of confirmed data.
Then <span class="math inline">\(w_{ij} \in \{0, A, B, AB\}\)</span>, with <span class="math inline">\(0\)</span> corresponding to sites where either <span class="math inline">\(y_{ij} = 0\)</span> or no individuals were selected for confirmation.
The PCD is given by <span class="math display">\[PCD = \frac{\sum_i \sum_j I(w_{ij} \neq 0)}{\sum_i \sum_j I(y_{ij}\neq 0)}.\]</span>
To distinguish sites where <span class="math inline">\(w_{ij} = 0\)</span> from ones where <span class="math inline">\(w_{ij} \neq 0\)</span>, the authors introduce yet another variablem, <span class="math inline">\(g_{ij}\)</span>, which is just <span class="math inline">\(w_{ij}\)</span> collapsed to a binary variable.
Finally, they introduce the parameter <span class="math inline">\(\eta^k, k\in\{A, B\}\)</span> to be the probability that only species <span class="math inline">\(k\)</span> is confirmed at a site where both are present.
The probabilities associated with the confirmatory states <span class="math inline">\(w_{ij}\)</span> are given in the <span class="math inline">\(\Omega\)</span> matrix below:</p>
<div class="layout-chunk" data-layout="l-body">
<p><img src="Omega.png" width="702" style="display: block; margin: auto;" /></p>
</div>
<p>With all of this notation, the likelihood can be written as</p>
<p><span class="math display">\[
L(\boldsymbol{\theta}| \boldsymbol{h},\boldsymbol{g})  = \prod_{i = 1}^{I}Pr(h_i|g_i, \boldsymbol{\theta}),\\
Pr(h_i|g_i, \boldsymbol{\theta}) = \Phi \times \left[ \prod_{j = 1}^{J_i} (\Pi_{y_{ij}} \times \Omega_{w_{ij}}) \right],
\]</span></p>
<p>where <span class="math inline">\(\Pi_{y_{ij}}\)</span> and <span class="math inline">\(\Omega_{w_{ij}}\)</span> are column vectors in their respective matrices, and <span class="math inline">\(\boldsymbol{\theta}\)</span> is shorthand for all of the model parameters.</p>
<h4 id="notes-2">Notes</h4>
<ul>
<li>The confirmation process assumes that individuals are confirmed, so it is possible to have partial vetting at a site visit.</li>
<li>The appendix includes a multi-season extension</li>
<li>The model performed poorly for parameters near the boundary of the probability domain</li>
</ul>
<h2 id="section-2">2020</h2>
<h3 id="wright20-modelling-misclassification-in-multispecies-acoustic-data-when-estimating-occupancy-and-relative-activity"><span class="citation" data-cites="wright20">(<a href="#ref-wright20" role="doc-biblioref">Wright et al., 2020</a>)</span> Modelling misclassification in multi‐species acoustic data when estimating occupancy and relative activity</h3>
<h4 id="summary-4">Summary</h4>
<p>Motivated by bat surveys that employ autonomous recording units (ARUs), the authors introduce a model capable of analyzing counts from multiple species simultaneously while accounting for false-positive detections that arise as a result of species misclassification. This approach expands on previously developed false-positive models; the authors use simulation to characterize model performance and to compare the performance of their model to these existing models, all of which use simplifying assumptions for analysis (e.g., counts summed to binary or data only from a single focal species). The authors then apply to count-detection model to bat ARU data from the Montana Natural Heritage Program.</p>
<h4 id="model-specification-4">Model specification</h4>
<p>Let <span class="math inline">\(i = 1, 2, \dots, n\)</span> denote site, <span class="math inline">\(j = 1, 2, \dots, J\)</span> denote visit, and <span class="math inline">\(k = 1, 2, \dots, K\)</span> denote species. Then, let</p>
<ul>
<li><span class="math inline">\(Z_{ik}\)</span> represent the latent, partially observed occupancy state of species <span class="math inline">\(k\)</span> at site <span class="math inline">\(i.\)</span></li>
<li><span class="math inline">\(\psi_{ik}\)</span> denote the probability that site <span class="math inline">\(i\)</span> is occupied by species <span class="math inline">\(k.\)</span></li>
<li><span class="math inline">\(Y_{ijk}\)</span> be the number of detections from species <span class="math inline">\(k\)</span> on visit <span class="math inline">\(j\)</span> to site <span class="math inline">\(i.\)</span> This is not directly observed in the presence of an imperfect classifier.</li>
<li><span class="math inline">\(\lambda_{ijk}\)</span> denote the expected number of detections from species <span class="math inline">\(k\)</span> per visit to site <span class="math inline">\(i.\)</span></li>
<li><span class="math inline">\(\theta_{k,k^\prime}\)</span> denote the probability that the software classification algorithm classifies a call from species <span class="math inline">\(k\)</span> to species <span class="math inline">\(k^\prime.\)</span> These probabilities are organized into a confusion matrix <span class="math inline">\(\Theta,\)</span> where each row corresponds to the true species and each column to the ID label generated by the classifier.</li>
<li><span class="math inline">\(\boldsymbol{C}_{ijk}\)</span> be a vector of length <span class="math inline">\(K\)</span> containing the counts attributed to each species by the classifier. This vector is directly observed. The elements of <span class="math inline">\(\boldsymbol{C}_{ijk}\)</span> are denoted as <span class="math inline">\(C_{ijkk&#39;},\)</span> indicating the number of calls that are from species <span class="math inline">\(k\)</span> but were attributed to <span class="math inline">\(k&#39;.\)</span></li>
<li><span class="math inline">\(C_{ij. k^\prime}\)</span> denote the total number of calls assigned species label <span class="math inline">\(k&#39;.\)</span> These are the observed data and are ambiguous counts because they may contain calls that truly came from any of the <span class="math inline">\(k\)</span> species.</li>
</ul>
<p>The model is written as
<span class="math display">\[
Z_{ik} \sim Bernoulli(\psi_{ik}) \\
[Y_{ijk} | Z_{ik} = 1] \sim Poisson(\lambda_{ijk})\\
[\boldsymbol{C}_{ijk}| Z_{ik} = 1, Y_{ijk} = y_{ijk}] \sim Multinomial(y_{ijk}, \Theta)\\
C_{ij.k&#39;} = \sum_{k = 1}^K{C_{ijkk&#39;}}
\]</span></p>
<h2 id="section-3">2021</h2>
<h3 id="clare21-generalized-model-based-solutions-to-false-positive-error-in-species-detectionnondetection-data"><span class="citation" data-cites="clare21">(<a href="#ref-clare21" role="doc-biblioref">Clare, Townsend and Zuckerberg, 2021</a>)</span> Generalized model-based solutions to false-positive error in species detection/nondetection data</h3>
<h4 id="summary-5">Summary</h4>
<p>The authors seek to formulate a general model that accounts for false-positive detections and for which all existing model-based solutions to false-positive contamination are special cases. The authors’ model specification is very simple, but some nuance is required to massage existing notation into the form of <span class="math inline">\(\theta_{tp}\)</span> and <span class="math inline">\(\theta_{fp},\)</span> which that authors do for three existing models in their lit review. The authors conduct a simulation study for two extensions: the RN (Royle-Nicols) and the PA (Phenological “arrival”) models. The authors find that failing to account for false-positive detections led to large gains in relative bias in the RN model, even when the percent of detections that were FPs was low. The PA model performed similarly.
Finally, the authors apply their model to Gray Fox data from Wisconsin, finding that when false-positive detections are ignored, estimated abundance across wide spatial extents is more than 3 times higher than when these false positives are accounted for.</p>
<h4 id="model-specification-5">Model Specification</h4>
<p>A generalized model-based solution turns out to be anything that contains
<span class="math display">\[
y_{ij} \sim Bernoulli(\theta_{tp}\cup \theta_{fp})
\]</span>
in the likelihood statement. In this formulation ,</p>
<p><span class="math inline">\(\theta_{tp}\)</span> and <span class="math inline">\(\theta_{fp}\)</span> are the probabilities of true- and false-positive detections, respectively; <span class="math inline">\(y_{ij}\)</span> is a binary detection/nondetection from sampling occasion <span class="math inline">\(j\)</span> at site <span class="math inline">\(i.\)</span></p>
<h2 id="section-4">2022</h2>
<h3 id="spiers22-estimating-species-misclassification-with-occupancy-dynamics-and-encounter-rates-a-semi-supervised-individual-level-approach"><span class="citation" data-cites="spiers22">(<a href="#ref-spiers22" role="doc-biblioref">Spiers et al., 2022</a>)</span> Estimating species misclassification with occupancy dynamics and encounter rates: A semi-supervised, individual-level approach</h3>
<h4 id="summary-6">Summary</h4>
<p>The authors introduce a version of the count detection model proposed by <span class="citation" data-cites="wright20">Wright et al. (<a href="#ref-wright20" role="doc-biblioref">2020</a>)</span> that exchanges the multinomial likelihood for a categorical distribution and models calls on an individual level. The authors also include elements of a dynamic occupancy model with terms for colonization and extinction and allow the confusion matrix to be rectangular to accommodate the possibility of a morphospecies designation (which leads to more possible species designations than species present). The authors fit the model to carabid beetle data where the imperfect classifier is a parataxonomist; they use these data to compare the performance of their model against a reduced, classification-only model without reference to occupancy dynamics. Finally, the authors conducted a simulation study similar to ours (2 species and 3 classification categories) and found only modest gains in performance as the level of validation effort increased.</p>
<h4 id="model-specification-6">Model specification</h4>
<p>Let the indices be as for the count detection model of <span class="citation" data-cites="wright20">Wright et al. (<a href="#ref-wright20" role="doc-biblioref">2020</a>)</span>. Include a new index, <span class="math inline">\(t = 1,2,3, \dots, T\)</span> to indicate the season in which an observation was measured. Once the total number of individuals encountered, <span class="math inline">\(L_{ij.t},\)</span> is accounted for, let <span class="math inline">\(l = 1,2,\dots,L_{ij.t}\)</span> indicate the individual whose species label (either true or automatically identified) is being modeled.</p>
<p>Under this model, let</p>
<ul>
<li><span class="math inline">\(Z_{ikt}\)</span> represent the latent, partially observed occupancy state of species <span class="math inline">\(k\)</span> at site <span class="math inline">\(i\)</span> during time <span class="math inline">\(t.\)</span></li>
<li><span class="math inline">\(\psi_{ikt}\)</span> denote the probability that site <span class="math inline">\(i\)</span> is occupied by species <span class="math inline">\(k\)</span> during season <span class="math inline">\(t.\)</span></li>
<li><span class="math inline">\(\phi_{ikt}\)</span> denote the probability that a species <span class="math inline">\(k\)</span> persists at site <span class="math inline">\(i\)</span> during time <span class="math inline">\(t.\)</span></li>
<li><span class="math inline">\(\gamma_{ikt}\)</span> denote the probability that a species colonizes a given site during time <span class="math inline">\(t.\)</span></li>
<li><span class="math inline">\(\lambda_{ijk}\)</span> denote the expected number of detections from species <span class="math inline">\(k\)</span> per visit to site <span class="math inline">\(i.\)</span></li>
<li><span class="math inline">\(\theta_{k,k^\prime}\)</span> denote the probability that the software classification algorithm classifies a call from species <span class="math inline">\(k\)</span> to species <span class="math inline">\(k^\prime.\)</span> These probabilities are organized into a confusion matrix <span class="math inline">\(\Theta,\)</span> where each row corresponds to the true species and each column to the ID label generated by the classifier.</li>
<li><span class="math inline">\(L_{ijkt}\)</span> denote the total number of individuals of species <span class="math inline">\(k\)</span> encountered of visit <span class="math inline">\(j\)</span> to site <span class="math inline">\(i\)</span> during time <span class="math inline">\(t.\)</span> Note that when there is imperfect classification of individuals these counts are not directly observed. The sum over species, <span class="math inline">\(L_{ij.t}\)</span> is the total number of individuals encountered on a given survey to a site and <em>is</em> observable.</li>
<li><span class="math inline">\(y_{ijlt}\)</span> denote the imperfect classification of individual <span class="math inline">\(l\)</span> encountered at site <span class="math inline">\(i,\)</span> visit <span class="math inline">\(j,\)</span> season <span class="math inline">\(t.\)</span></li>
<li><span class="math inline">\(k[ijlt]\)</span> denote the partially observed (for confirmed individuals) true species label of individual <span class="math inline">\(l\)</span> at a given site-visit during season <span class="math inline">\(t.\)</span></li>
</ul>
<p><span class="math display">\[
z_{ikt} \sim  Bernoulli(\psi_{ikt})\\
\psi_{ikt} = z_{i,k,t-1}\phi_{i,k,t-1} + (1-z_{i,k,t-1})\gamma_{i,k,t-1}\\
L_{ij.t} = \sum_{k=1}^{K}L_{ijkt} \sim Poisson \left(\sum_{k=1}^{K}z_{ikt}\lambda_{ikt}\right)\\
y_{ijkt} \sim Categorical(\theta_{k[ijlt]})\\
k[ijlt] \sim Categorical \left( \frac{z_{ikt}\lambda_{ikt}}{\sum_{k=1}^Kz_{ikt}\lambda_{ikt}} \right)
\]</span></p>
<h4 id="notes-3">Notes</h4>
<ul>
<li>Simulation study used data-generating values that were randomly generated from the priors used during the case study.
<ul>
<li>This may not be intentional, but this approach introduces the assumption that the distribution for <span class="math inline">\(\psi_k\)</span> is mound-shaped, symmetric with mean/median near 0.5, regardless of site (see figures below).</li>
<li>The simulated values used in the following figure were generated using code from the <code>simulation.R</code> file on the authors’ Zenodo page.</li>
</ul></li>
</ul>
<div class="layout-chunk" data-layout="l-body">
<p><img src="densities.png" width="1050" style="display: block; margin: auto;" /></p>
</div>
<ul>
<li><span class="math inline">\(\lambda\)</span> follows a right-skewed distribution and also tends to focus on ‘nice’ values. There are values up to 60 or so, but the bulk of the mass is between 0 and 1.</li>
</ul>
<div class="layout-chunk" data-layout="l-body">
<p><img src="lam_density.png" width="1050" style="display: block; margin: auto;" /></p>
</div>
<ul>
<li><p>These values for <span class="math inline">\(\psi\)</span> and <span class="math inline">\(\lambda\)</span> are not distributed throughout the parameter space, and so the authors’ simulation results are conditional on having species like these.</p></li>
<li><p>Focus in simulation study was on predictive performance, rather than inference of ecological parameters.</p></li>
<li><p>I’m unclear as to how predicted species identity was derived:</p></li>
</ul>
<blockquote>
<blockquote>
<p>For the purposes of calculating the validation metrics, we compare the true species identity, which is known in the simulations, to the distribution of median estimated species identities.
That is, the estimated species identities are selected as the species that the median from the categorical posterior distribution (see Observation model: classification) lies on for each of the 1,200 chains for each iteration of every dataset.</p>
</blockquote>
</blockquote>
<ul>
<li>The authors used <span class="math inline">\(K=2\)</span> species and <span class="math inline">\(\tilde{K} = 3\)</span> species designations, including one morphospecies. There were 15000 datasets, each with 30 sites and 3 visits.</li>
</ul>
<h3 id="clement22-estimating-occupancy-from-autonomous-recording-unit-data-in-the-presence-of-misclassifications-and-detection-heterogeneity"><span class="citation" data-cites="clement22">(<a href="#ref-clement22" role="doc-biblioref">Clement, Royle and Mixan, 2022</a>)</span> Estimating occupancy from autonomous recording unit data in the presence of misclassifications and detection heterogeneity</h3>
<h4 id="summary-7">Summary</h4>
<p>The authors propose a two-species false-positive N-mixture model that they claim accounts for misclassification and abundance-induced detection heterogeneity when estimating occupancy from ARU data.
The model does not require manual verification of any recorded detections to estimate occupancy and incorporates abundance as a latent variable in both the state and detection components of the model.
The authors simulated data under the N-mixture model with a variety of scenarios for <span class="math inline">\(\mu,\)</span> <span class="math inline">\(r,\)</span> <span class="math inline">\(\lambda\)</span> and <span class="math inline">\(\omega\)</span> parameters.
The authors then compared the performance of a) a reduced presence/absence model, b) the count detection model, and c) the N-mixture model.
Simulations resulted in excellent performance (e.g., convergence, bias, RMSE, coverage) for the N-mixture model and low convergence with some bias for the count detection model.
After simulations, the authors applied the model to MYCI and MYYU bat data from two sites in Colorado, finding the N-mixture model to produce more plausible estimates than either competitor model.</p>
<h4 id="model-specification-7">Model specification</h4>
<p>Let <span class="math inline">\(i = 1,2,\dots, R\)</span> index site, and let <span class="math inline">\(j = 1,2,\dots, T\)</span> index visit. Furthermore, let</p>
<ul>
<li><span class="math inline">\(N_i^A\)</span> be the site-specific abundance of species A.</li>
<li><span class="math inline">\(\mu^A\)</span> be the mean abundance for species A.</li>
<li><span class="math inline">\(r^A\)</span> be an overdispersion parameter.</li>
<li><span class="math inline">\(\lambda^A\)</span> be the expected number of true encounters with an individual of speciesA</li>
<li><span class="math inline">\(\omega^B\)</span> be the expected number of false-positive encounters with an individual of species * <span class="math inline">\(c_{ij}^A\)</span> be the number of individuals that are autoID’d to species A on visit <span class="math inline">\(j\)</span> to site <span class="math inline">\(i.\)</span></li>
</ul>
<p>The model is as follows:</p>
<p><span class="math display">\[
N_i^A \sim NegBin(\mu^A, r^A)\\
N_i^B \sim NegBin(\mu^B, r^B) \\
c_{ij}^A \sim Poisson(N_i^A\lambda^A + N_i^B\omega^B)\\
c_{ij}^B \sim Poisson(N_i^B\lambda^B + N_i^A\omega^A)
\]</span></p>
<h4 id="notes-4">Notes</h4>
<ul>
<li><p>The parameter <span class="math inline">\(\lambda^A\)</span> used by <span class="citation" data-cites="clement22">Clement et al. (<a href="#ref-clement22" role="doc-biblioref">2022</a>)</span> has two key differences with <span class="math inline">\(\lambda_{A_w}\)</span> (where the extra <span class="math inline">\(w\)</span> subscript indicates that this parameter is in the notation of <span class="citation" data-cites="wright20">Wright et al. (<a href="#ref-wright20" role="doc-biblioref">2020</a>)</span>):</p>
<ul>
<li><span class="math inline">\(\lambda^A\)</span> indicates the individual level encounter rate (i.e., the expected number of calls from an individual of species A)</li>
<li><span class="math inline">\(\lambda^A\)</span> represents true-positive detections, so that <span class="math inline">\(N_A \lambda^A = \lambda_{A_w} * \theta_{AA}.\)</span></li>
</ul></li>
<li><p>The above observations also highlights the additional information afforded by the count detection model: it characterizes the classifier separately from the ecological parameters. (Edit: We can obtain the classification parameters <span class="math inline">\(\theta\)</span> through combinations of <span class="math inline">\(\lambda\)</span> and <span class="math inline">\(\omega\)</span> terms.)</p></li>
<li><p>For some of the extensions proposed, an exogenous source of false-positives is added to the mean of the poisson likelihood: <span class="math inline">\(\omega^{eA},\)</span> for example. The authors add a constraint that we must have <span class="math inline">\(\lambda^A &lt; \omega^{eA},\)</span> but don’t indicate why the false-positive rate must be greater than the true detection rate. Presumably this is for identifiability, but it isn’t discussed and seems that it may not be realistic in all cases.</p></li>
</ul>
<h3 id="irvine22-statistical-assessment-on-determining-local-presence-of-rare-bat-species"><span class="citation" data-cites="irvine22">(<a href="#ref-irvine22" role="doc-biblioref">Irvine et al., 2022</a>)</span> Statistical assessment on determining local presence of rare bat species</h3>
<h4 id="summary-8">Summary</h4>
<p>The authors critically examine the performance of the current standard for the USFWS (“MLE-metric”) in determining the presence or absence of rare species. This existing method, which uses the p-value from a multinomial likelihood ratio test is contrasted with the count detection model of <span class="citation" data-cites="wright20">Wright et al. (<a href="#ref-wright20" role="doc-biblioref">2020</a>)</span> and two other false-positive occupancy models. Methods comparison is based on a simulation study which varies the characteristics of the classifier, assemblage and detection probability and is evaluated based on the median correct decisions among sites. The authors found that the count detection model outperformed existing methods: the remove approach overestimated <span class="math inline">\(\psi\)</span> and underestimated <span class="math inline">\(p\)</span> regardless of the simulation settings, while the naive model overestimated both and most often led to the correct decision about the true presence of a rare species. The authors conclude by proposing that the count detection model be used more widely to allow the integration of local, targeted data with rangewide information and providing a possible framework for predicting species occurrence.</p>
<h4 id="model-specification-8">Model specification</h4>
<p>For the MLE-metric, the multinomial likelihood is written as</p>
<p><span class="math display">\[
L(\boldsymbol{n}, \theta) \propto \prod_k\left(\sum_{k&#39; = 1}^K \phi_{kk&#39;}\theta_k^B \right)^{n_k}
\]</span></p>
<p>where <span class="math inline">\(\phi_{kk&#39;}\)</span> is the (assumed known) probability that calls from species <span class="math inline">\(k&#39;\)</span> are classified to species <span class="math inline">\(k;\)</span> <span class="math inline">\(\theta_k^B\)</span> is the (unknown) relative frequency of species <span class="math inline">\(k\)</span> in the sampled community; <span class="math inline">\(n_k\)</span> is the number of calls assigned to species <span class="math inline">\(k,\)</span> and <span class="math inline">\(N\)</span> is the sum of <span class="math inline">\(n_k\)</span> values, representing the total number of calls recorded and assigned a species label.
If a likelihood ratio test (denoted as an “MLE-metric” by the authors; hypotheses of the test are given in the notes section below) yields <span class="math inline">\(p &lt; \alpha = 0.05,\)</span> the species is determined to be present at the site visit and is recorded as a 1 in the detection history that is modeled using an occupancy model:</p>
<p><span class="math display">\[
Z_i \sim Bernoulli(\psi_i) \\
Y_{ij} | Z_i \sim Bernoulli(Z_i \space p_{ij}).
\]</span></p>
<p>This is the “remove” model described by the authors; the “naive” model does not have the preprocessing step to remove false positives by applying the MLE-metric in the LRT.
The final model-based approach that is compared in the authors’ simulation study is the count detection model <span class="citation" data-cites="wright20">(<a href="#ref-wright20" role="doc-biblioref">Wright et al., 2020</a>)</span>.</p>
<h4 id="notes-5">Notes</h4>
<ul>
<li>Two spatial scales: site-level (binary decision about presence/absence to determine management actions) vs. range-wide (i.e., NABAT’s longterm monitoring of all species)
<ul>
<li>Possibly unrealized potential to combine these two scales into a single statistical framework</li>
</ul></li>
<li>MLE metric assumes that classification probabilities are known !</li>
<li>Null hypothesis in LRT is <span class="math inline">\(H_0:\theta_k^B= 0\)</span> (i.e., the species is absent from the site) vs. <span class="math inline">\(H_A: \theta_K^B &gt; 0\)</span>
<ul>
<li>Current standard is <span class="math inline">\(\alpha&lt;0.05.\)</span></li>
</ul></li>
</ul>
<h3 id="stratton22-coupling-validation-effort-with-in-situ-bioacoustic-data-improves-estimating-relative-activity-and-occupancy-for-multiple-species-with-cross-species-misclassifications"><span class="citation" data-cites="stratton22">(<a href="#ref-stratton22" role="doc-biblioref">Stratton et al., 2022</a>)</span> Coupling validation effort with in situ bioacoustic data improves estimating relative activity and occupancy for multiple species with cross-species misclassifications</h3>
<h4 id="summary-9">Summary</h4>
<p>The authors perform two simulation studies based on bat acoustic data from British Columbia.
The first of these compares a) the coupled classification model, b) an uncoupled likelihood with auxiliary data and c) an uncoupled classification likelihood with informative priors instead of auxiliary data to inform the <span class="math inline">\(\Theta\)</span> matrix.
For comparing a) and b), the authors use three different prior specifications: uniform on simplex, informative and reference distance.
In the second simulation study, the authors examine validation effort using the empirical bat data.
The authors find that the coupled classification model outperformed the uncoupled model regardless of the prior structure.
Of the prior structures investigated, the reference distance prior performed best for estimating the elements of the confusion matrix.
In the second simulation, none of the fitted models converged for the lowest 4 validation scenarios; this appeared to be driven by the rarest species receiving an insufficient number of calls.
Credibility interval width did not appear to be affected by the level of validation effort.
The authors conclude with a example analysis from the HM scenario, which was the lowest level of effort where models consistently converged for all parameters, and discuss the need for a quota sampling strategy for validation, motivating our paper.</p>
<h4 id="model-specification-9">Model specification</h4>
<p>As in the notation of <span class="citation" data-cites="wright20">Wright et al. (<a href="#ref-wright20" role="doc-biblioref">2020</a>)</span>, let <span class="math inline">\(i\)</span> index the site, <span class="math inline">\(j\)</span> index visit to the site and let <span class="math inline">\(k\)</span> index the spcies. Then the coupled classification model may be written as</p>
<p><span class="math display">\[
Z_{ik} \sim Bernoulli(\psi_{ik}) \\
Y_{ijk} | Z_{ik} \sim Poisson\left( z_{ik}\lambda_{ijk} \right) \\
c_{ij.k&#39;} \sim Poisson\left( \sum_k z_{ik}\lambda_{ijk}\theta_{kk&#39;}  \right) \\
c_{ijkk&#39;} \sim Poisson(z_{ik}\lambda_{ijk}\theta_{kk&#39;}),
\]</span></p>
<p>where <span class="math inline">\(Z,\)</span> <span class="math inline">\(Y,\)</span> <span class="math inline">\(c_{ijkk&#39;}\)</span> and <span class="math inline">\(c_{ij.k&#39;}\)</span> are as defined above (see <span class="citation" data-cites="wright20">Wright et al. (<a href="#ref-wright20" role="doc-biblioref">2020</a>)</span> entry for details). If auxiliary data are included (instead of by using a coupled classification approach), these data may be incorporated into the model via a multinomial distribution.</p>
<h3 id="adjei22-accounting-for-misclassification-in-multispecies-distribution-models"><span class="citation" data-cites="adjei22">(<a href="#ref-adjei22" role="doc-biblioref">Adjei et al., 2022</a>)</span> Accounting for Misclassification in Multispecies Distribution Models</h3>
<h4 id="summary-10">Summary</h4>
<p>Motivated by the potential to use citizen science data, which is known to contain species identification errors, the authors propose a new model which reframes the count detection model in terms of a inhomogeneous Poisson point process (IPP). The authors demonstrate their model by simulation, with RMSE and coverage used as measures of model performance and assuming using an assemblage of three species with four possible designations. Finally, the authors apply their model to butterfly data in the US.</p>
<h4 id="model-specification-10">Model specification</h4>
<p>Let <span class="math inline">\(D \in \mathbb{R}^2\)</span> be the study region.
Let <span class="math inline">\(i = 1,2, \dots , R\)</span> index the location, with one of <span class="math inline">\(s = 1,2, \dots, S\)</span> true individuals (I take this to mean true species identifications of an individual) at each location.
Then, define the mean intensity of species <span class="math inline">\(s\)</span> occurence at location <span class="math inline">\(i\)</span> as <span class="math inline">\(\lambda_{is}.\)</span>
Covariates can inform the mean intensity through a GLM framework:</p>
<p><span class="math display">\[ln(\lambda_{is}) = \beta_{0_s} + \beta_{1_s}^{&#39;}X.\]</span>
The observed response data inform the mean intensity through an inhomogeneous point process model. Here, the count of species detections in the study region are realizations from a poisson distribution with mean <span class="math inline">\(\mu_s(D) = \int_D \lambda_s dx\)</span> where <span class="math inline">\(dx\)</span> is the two dimensional volume element. The locations of are sampled from the probability distribution with density proportional to intensity at that location: <span class="math inline">\(f_s(i) = \lambda_s(i)/\mu_s(D).\)</span></p>
<p>Next, define <span class="math inline">\(p_{is}\)</span> as the probability of observing species <span class="math inline">\(s\)</span> at location <span class="math inline">\(i.\)</span> This probability is modeled as</p>
<p><span class="math display">\[p_{is} = \frac{\lambda_{is}}{\sum_{s = 1}^S \lambda_{is}}.\]</span></p>
<p>Then, the realized true states are categorically distributed:
<span class="math display">\[V_i \sim Categorical(p_{is})\]</span></p>
<p>The previous distributions describe the true latent state.
To model the classification process, the authors define a rectangular (<span class="math inline">\(S \times K\)</span>) confusion matrix <span class="math inline">\(\boldsymbol{\Omega}\)</span> that allows for <span class="math inline">\(S\)</span> true species labels and <span class="math inline">\(K\)</span> identifications, including categories such as “unidentified woodpecker.”
Conditional <span class="math inline">\(\Omega\)</span> and the verified (true) species <span class="math inline">\(V_i,\)</span> the assigned species label is given by
<span class="math display">\[Y_i|V_i = v \sim Categorical(\boldsymbol{\Omega}_v).\]</span></p>
<h4 id="notes-6">Notes</h4>
<ul>
<li><p>The explanation of the IPP was from <a href="https://www.sciencedirect.com/topics/mathematics/inhomogeneous-poisson-process">Science Direct</a> and is included to jog my memory.</p></li>
<li><p>Notation is essentially the same as the latent true species label <span class="math inline">\(k[ijl]\)</span> used by <span class="citation" data-cites="spiers22">Spiers et al. (<a href="#ref-spiers22" role="doc-biblioref">2022</a>)</span>.
Additionally, the rectangular confusion matrix is familiar, a la <span class="citation" data-cites="spiers22">Spiers et al. (<a href="#ref-spiers22" role="doc-biblioref">2022</a>)</span>.</p></li>
<li><p>This may not be the most useful model in the context of bat applications because it requires detection of individuals at random locations, rather than detection and classification at fixed points (i.e., where the detector gets deployed).</p></li>
<li><p>Unclear whether we must have verified true state for all locations/observations or just a subset.</p></li>
<li><p>The authors do not explore validation effort for this model and make the assumption that community-verified identifications are error-free.</p></li>
</ul>
<p>Finally, the true species is predicted as</p>
<p><span class="math display">\[
\Gamma_{iks} = \frac{\omega_{sk} \frac{\hat{\lambda_{is}}}{\sum_{s}\hat{\lambda_{is}}}}{\sum_{s} \left[\omega_{sk} \frac{\hat{\lambda_{is}}}{\sum_{s}\hat{\lambda_{is}}}\right]}
\]</span></p>
<h3 id="rhinehart22-a-continuous-score-occupancy-model-that-incorporates-uncertain-machine-learning-output-from-autonomous-biodiversity-surveys"><span class="citation" data-cites="rhinehart22">(<a href="#ref-rhinehart22" role="doc-biblioref">Rhinehart, Turek and Kitzes, 2022</a>)</span> A continuous-score occupancy model that incorporates uncertain machine learning output from autonomous biodiversity surveys</h3>
<h4 id="summary-11">Summary</h4>
<p>The authors reframe the question of modeling ARU data in terms of the continuous scores that are output from ML algorithms for each call file; these continuous scores are modeled as a Gaussian mixture, where one component models files that contain the focal species, and the other models files that do not.
The authors demonstrate their model’s performance by simulation and make comparisons with a naïve single-season single-species occupancy model.
The authors find that if the difference in true means of the Gaussian distributions are less than 0.1, the model fails.
Once these simulations were removed, model performance was excellent with less bias and greater precision than the naïve model.
The authors also validate their model’s use empirically, and investigate the effect of annotation (call file confirmation), finding that when training data for the classifier contained a representative sample of species’ calls the gaussian mixture was able to adequately estimate occupancy under most validation scenarios.</p>
<h4 id="model-specification-11">Model specification</h4>
<p>Let <span class="math inline">\(i\)</span> index site, and let <span class="math inline">\(f_{i,k_i}\)</span> be a single recording from site <span class="math inline">\(i.\)</span>
Further, let <span class="math inline">\(k_i = 1,2,\dots,K_i\)</span> denote the call file number; there are <span class="math inline">\(K_i\)</span> total files recorded at site <span class="math inline">\(i.\)</span>
Next, let</p>
<ul>
<li><span class="math inline">\(Z_i\)</span> be the partially observed occupancy state of site <span class="math inline">\(i\)</span></li>
<li><span class="math inline">\(\psi\)</span> denote the probability of occupancy by the focal species. For simplicity this is assumed constant across sites.</li>
<li><span class="math inline">\(f_{i,k_i}\)</span> denote the binary random variable that takes on value 1 when the focal species is present in the recording and 0 otherwise.</li>
<li><span class="math inline">\(s_{i,k_i}\)</span> be the score of the <span class="math inline">\(k_i\)</span>th recording from site <span class="math inline">\(i.\)</span></li>
<li><span class="math inline">\(\theta\)</span> denote the ‘appearance rate’ for the focal species. See notes.</li>
<li><span class="math inline">\(\mu\)</span> be the mean classifier scores</li>
<li><span class="math inline">\(\sigma^2\)</span> denote the variance of the classifier scores</li>
</ul>
<p><span class="math display">\[
Z_i \sim Bernoulli(\psi)\\
f_{i,k_i} \sim Bernoulli(z_i \theta)\\
[s_{i,{k_i}} | f_{i,{k_i}} = 0] \sim N(\mu_0, \sigma^2_0) \\
[s_{i,k_i}| f_{i,k_i} = 1] \sim N(\mu_1, \sigma^2_1)
\]</span></p>
<p>To extend the model by including random subset of validated recordings let</p>
<ul>
<li><span class="math inline">\(h_{i,k_i}\)</span> denote the confirmation status of the <span class="math inline">\(k_i\)</span>th file.
<ul>
<li><span class="math inline">\(h_{i,k_i}= 0\)</span> if file does not contain the focal species</li>
<li><span class="math inline">\(h_{i,k_i} = 1\)</span> if file does contain the focal species</li>
<li><span class="math inline">\(h_{i,k_i} = 2\)</span> if the file is not manually reviewed</li>
</ul></li>
<li><span class="math inline">\(\pi_{i,k_i}\)</span> denote the probability of observing score <span class="math inline">\(s_{i,k_i}.\)</span> See Table 1 in the authors’ original paper for the form of <span class="math inline">\(\pi,\)</span> which changes depending on the combination of confirmation status and partially observed occupancy state. The full likelihood may be written as</li>
</ul>
<p><span class="math display">\[
L(\psi, \theta, \boldsymbol{\mu}, \boldsymbol{\sigma}| \boldsymbol{S, \space H}) =
\prod_{i} \left[
(1 - \psi) \prod_{k_i = 1}^{K_i} \pi_i(s_{i,k_i} | z_i = 0, h_{i,k_i}) +
\psi \prod_{k_i = 1}^{K_i} \pi_i(s_{i,k_i} | z_i = 1, h_{i,k_i})
\right].
\]</span></p>
<h4 id="notes-7">Notes</h4>
<ul>
<li>The authors note that <span class="math inline">\(\theta\)</span> can be thought of as encoding all of the factors that lead to the presence of a species in a call file; this includes the species calling rate and also its availability for successful recording.
<ul>
<li>Within a site, <span class="math inline">\(\theta\)</span> is also the weight assigned to the species-present component of the mixture.</li>
<li>Across sites, the weight assigned to the species-present component of the mixture changes to <span class="math inline">\(\theta\psi\)</span></li>
</ul></li>
<li>Without validation data, likely need the assumption <span class="math inline">\(\mu_1 &gt; \mu_0\)</span> for identifiability.</li>
<li>This is likely more of an alternative to a single-season, single-species occupancy model (e.g., MacKenzie 2002) than to the count detection model.
<ul>
<li>However, in their case study, the authors apply this model to multiple species, by applying it one at a time to each. It would be interesting to see how this might be extended to explicitly include the assumption that a call that does not contain the focal species does contain another.</li>
</ul></li>
</ul>
<h3 id="doser22-integrated-community-occupancy-models-a-framework-to-assess-occurrence-and-biodiversity-dynamics-using-multiple-data-sources"><span class="citation" data-cites="doser22">(<a href="#ref-doser22" role="doc-biblioref">Doser et al., 2022</a>)</span> Integrated community occupancy models: A framework to assess occurrence and biodiversity dynamics using multiple data sources</h3>
<h4 id="summary-12">Summary</h4>
<p>The authors propose integrating multiple (assumed independent) data sources into a hierarchical “integrated community occupancy model” (ICOM).
The hierarchical structure of this model allows inference at the site and species levels but also at the community level through estimation of the grand means (<span class="math inline">\(\mu\)</span> terms) of the species-specific regression coefficients.
The authors conduct two simulation studies to assess the potential benefits of 1) integrating multiple sources of data and 2) community-level modeling.
The authors also applied their ICOM model to data from foliage-gleaning birds in the White Mountains of New Hampshire.
The authors found that integrating simulated data sources yielded lower bias and greater precision than when data sources were used individually; they also found that including community estimation hierarchically improved the estimation of species-specific parameters.
In their case study, the authors found that, in contrast with the simulations, models fit to fully-integrated data did not always yield the highest precision when compared with models that only used a subset of the datasets.</p>
<h4 id="model-specification-12">Model specification</h4>
<p>In the process model, let <span class="math inline">\(i\)</span> denote species, <span class="math inline">\(j\)</span> index site and <span class="math inline">\(t\)</span> denote year. In the replicated observation model, let <span class="math inline">\(r = 1,2, \dots, R\)</span> denote a subset of the J sites and let <span class="math inline">\(k = 1,2,\dots,K\)</span> denote the ‘replicate’ number of an observation at site <span class="math inline">\(r.\)</span> In the unreplicated observation model, let <span class="math inline">\(m\)</span> denote the subset of all <span class="math inline">\(J\)</span> sites that do not receive a replicate observation. Note that the set of sites that receive unreplicated observations and the set of sites that do receive replicate observations need not be mutually exclusive since the data sources are not the same that feed each. Then let</p>
<ul>
<li><span class="math inline">\(z\)</span> denote the partially observed occupancy state of a site and species</li>
<li><span class="math inline">\(\psi\)</span> denote the probability of occupancy by a species at a site.</li>
<li><span class="math inline">\(X_{jt}\)</span> be standardized covariates for site <span class="math inline">\(j\)</span> at time <span class="math inline">\(t\)</span>.</li>
<li><span class="math inline">\(\boldsymbol{\beta}_i\)</span> be regression coefficients associated with each covariate contained in <span class="math inline">\(X.\)</span></li>
<li><span class="math inline">\(\phi_i\)</span> denote a (random) species-specific adjustment to the community level mean probability on the logit scale</li>
<li><span class="math inline">\(\mu\)</span> and <span class="math inline">\(\sigma^2\)</span> denote the community-level mean and variance for occupancy probabilities on the logit scale.</li>
<li><span class="math inline">\(y\)</span> be the binary detection/non-detection data for a replicated observation site and species</li>
<li><span class="math inline">\(p\)</span> be the detection probability at a replicated observation site.</li>
<li><span class="math inline">\(W\)</span> denote a matrix of covariates that pertain to a replicated observation <span class="math inline">\(k\)</span> at site <span class="math inline">\(r\)</span> during time <span class="math inline">\(t\)</span>.</li>
<li><span class="math inline">\(\boldsymbol{\alpha}\)</span> denote the regression coefficients that are associated with <span class="math inline">\(W\)</span> on the logit scale.</li>
<li><span class="math inline">\(v\)</span> denote the binary detection/nondetection data observed at unreplicated site <span class="math inline">\(m.\)</span></li>
<li><span class="math inline">\(\pi\)</span> denote the probability of detection species <span class="math inline">\(i\)</span> at site <span class="math inline">\(m\)</span> during time <span class="math inline">\(t.\)</span></li>
<li><span class="math inline">\(\boldsymbol{\gamma}\)</span> denote a vector of regression coefficients for covariates <span class="math inline">\(S\)</span> on site <span class="math inline">\(m\)</span> during time <span class="math inline">\(t.\)</span></li>
</ul>
<p>Let</p>
<p>The process/state model is</p>
<p><span class="math display">\[
z_{ijt} \sim Bernoulli(\psi_{ijt})\\
logit(\psi_{ij1}) = \beta_{0_{it}} + X_{j1}\boldsymbol{\beta_i} \\
logit(\psi_{ijt}) = \beta_{0_{it}}  + X_{jt}\boldsymbol{\beta_i} + \phi_iz_{ij(t-1)}\\
\beta_{0_{it}} \sim Normal(\mu_{\beta_{0_t}}, \sigma^2_{\beta_{0_t}})
\]</span></p>
<p>The replicated observation model is</p>
<p><span class="math display">\[
y_{irkt} \sim Bernoulli(p_{irkt}z_{ij[r]t})\\
logit(p_{irkt}) = \alpha_{0_{it}}+ W_{rkt}\boldsymbol{\alpha_i}
\]</span></p>
<p>Then the unreplicated observation process is modeled by yet another Bernoulli distribution:</p>
<p><span class="math display">\[
v_{imt} \sim Bernoulli(\pi_{imt} z_{ij[m]t})\\
logit(\pi_{imt}) = \gamma_{0_{it}} + \boldsymbol{S}_{mt} \gamma_i
\]</span></p>
<p>Note that while not explicitly stated, species-specific regression coefficients are modeled hierarchically in the process and observation models.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r distill-force-highlighting-css"><code class="sourceCode r"></code></pre></div>
<div id="refs" class="references csl-bib-body hanging-indent" role="doc-bibliography">
<div id="ref-adjei22" class="csl-entry" role="doc-biblioentry">
Adjei, K.P., O’Hara, R.B., Finstad, A.G. and Koch, W. (2022) <a href="https://doi.org/10.48550/ARXIV.2204.03708">Accounting for misclassification in multispecies distribution models</a>.
</div>
<div id="ref-chambert18b" class="csl-entry" role="doc-biblioentry">
Chambert, T., Grant, E.H.C., Miller, D.A.W., Nichols, J.D., Mulder, K.P. and Brand, A.B. (2018a) <a href="https://doi.org/10.1111/2041-210X.12985">Two-species occupancy modelling accounting for species misidentification and non-detection</a>. <em>Methods in Ecology and Evolution</em>, <strong>9</strong>, 1468–1477.
</div>
<div id="ref-chambert18" class="csl-entry" role="doc-biblioentry">
Chambert, T., Waddle, J.H., Miller, D.A.W., Walls, S.C. and Nichols, J.D. (2018b) <a href="https://doi.org/10.1111/2041-210X.12910">A new framework for analysing automated acoustic species detection data: Occupancy estimation and optimization of recordings post-processing</a>. <em>Methods in Ecology and Evolution</em>, <strong>9</strong>, 560–570.
</div>
<div id="ref-clare21" class="csl-entry" role="doc-biblioentry">
Clare, J.D.J., Townsend, P.A. and Zuckerberg, B. (2021) <a href="https://doi.org/10.1002/ecy.3241">Generalized model-based solutions to false-positive error in species detection/nondetection data</a>. <em>Ecology</em>, <strong>102</strong>, e03241.
</div>
<div id="ref-clement22" class="csl-entry" role="doc-biblioentry">
Clement, M.J., Royle, J.A. and Mixan, R.J. (2022) <a href="https://doi.org/10.1111/2041-210X.13895">Estimating occupancy from autonomous recording unit data in the presence of misclassifications and detection heterogeneity</a>. <em>Methods in Ecology and Evolution</em>, <strong>n/a</strong>.
</div>
<div id="ref-doser22" class="csl-entry" role="doc-biblioentry">
Doser, J.W., Leuenberger, W., Sillett, T.S., Hallworth, M.T. and Zipkin, E.F. (2022) <a href="https://doi.org/10.1111/2041-210X.13811">Integrated community occupancy models: A framework to assess occurrence and biodiversity dynamics using multiple data sources</a>. <em>Methods in Ecology and Evolution</em>, <strong>13</strong>, 919–932.
</div>
<div id="ref-ga17" class="csl-entry" role="doc-biblioentry">
Guillera-Arroita, G. and Lahoz-Monfort, J.J. (2017) <a href="https://doi.org/10.1007/s10182-017-0292-5">Species occupancy estimation and imperfect detection: Shall surveys continue after the first detection?</a> <em>AStA Advances in Statistical Analysis</em>, <strong>101</strong>, 381–398.
</div>
<div id="ref-ga17b" class="csl-entry" role="doc-biblioentry">
Guillera-Arroita, G., Lahoz-Monfort, J.J., Rooyen, A.R. van, Weeks, A.R. and Tingley, R. (2017) <a href="https://doi.org/10.1111/2041-210X.12743">Dealing with false-positive and false-negative errors about species occurrence at multiple levels</a>. <em>Methods in Ecology and Evolution</em>, <strong>8</strong>, 1081–1091.
</div>
<div id="ref-irvine22" class="csl-entry" role="doc-biblioentry">
Irvine, K.M., Banner, K.M., Stratton, C., Ford, W.M. and Reichert, B.E. (2022) <a href="https://doi.org/10.1002/ecs2.4142">Statistical assessment on determining local presence of rare bat species</a>. <em>Ecosphere</em>, <strong>13</strong>, e4142.
</div>
<div id="ref-rhinehart22" class="csl-entry" role="doc-biblioentry">
Rhinehart, T.A., Turek, D. and Kitzes, J. (2022) <a href="https://doi.org/10.1111/2041-210X.13905">A continuous-score occupancy model that incorporates uncertain machine learning output from autonomous biodiversity surveys</a>. <em>Methods in Ecology and Evolution</em>, <strong>13</strong>, 1778–1789.
</div>
<div id="ref-spiers22" class="csl-entry" role="doc-biblioentry">
Spiers, A.I., Royle, J.A., Torrens, C.L. and Joseph, M.B. (2022) <a href="https://doi.org/10.1111/2041-210X.13858">Estimating species misclassification with occupancy dynamics and encounter rates: A semi-supervised, individual-level approach</a>. <em>Methods in Ecology and Evolution</em>, <strong>13</strong>, 1528–1539.
</div>
<div id="ref-stratton22" class="csl-entry" role="doc-biblioentry">
Stratton, C., Irvine, K.M., Banner, K.M., Wright, W.J., Lausen, C. and Rae, J. (2022) <a href="https://doi.org/10.1111/2041-210X.13831">Coupling validation effort with in situ bioacoustic data improves estimating relative activity and occupancy for multiple species with cross-species misclassifications</a>. <em>Methods in Ecology and Evolution</em>, <strong>13</strong>, 1288–1303.
</div>
<div id="ref-wright20" class="csl-entry" role="doc-biblioentry">
Wright, W.J., Irvine, K.M., Almberg, E.S., Litt, A.R. and Yoccoz, N. (2020) Modelling misclassification in multi‐species acoustic data when estimating occupancy and relative activity. <em>Methods in ecology and evolution</em>, <strong>11</strong>, 71–81.
</div>
</div>
<!--radix_placeholder_article_footer-->
<!--/radix_placeholder_article_footer-->
</div>

<div class="d-appendix">
</div>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

<!--radix_placeholder_site_after_body-->
<!--/radix_placeholder_site_after_body-->
<!--radix_placeholder_appendices-->
<div class="appendix-bottom">
<h3 id="references">References</h3>
<div id="references-listing"></div>
</div>
<!--/radix_placeholder_appendices-->
<!--radix_placeholder_navigation_after_body-->
<!--/radix_placeholder_navigation_after_body-->

</body>

</html>
